<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banca do Marcos üéØ | Apostas Oficiais</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #000000;
            --secondary: #111111;
            --accent: #10B981;
            --accent-light: #34D399;
            --accent-dark: #059669;
            --danger: #EF4444;
            --warning: #F59E0B;
            --info: #3B82F6;
            --purple: #8B5CF6;
            --pink: #EC4899;
            --accent-gradient: linear-gradient(135deg, #10B981 0%, #059669 100%);
            --accent-gradient-hover: linear-gradient(135deg, #0DA271 0%, #047857 100%);
            --light: #FFFFFF;
            --light-secondary: #F8FAFC;
            --dark: #0F172A;
            --dark-secondary: #1E293B;
            --card-bg: rgba(255, 255, 255, 0.95);
            --card-bg-dark: rgba(30, 41, 59, 0.95);
            --text-primary: #000000;
            --text-secondary: #475569;
            --text-tertiary: #94A3B8;
            --border: #E2E8F0;
            --border-dark: #334155;
            --shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 30px 60px rgba(0, 0, 0, 0.12);
            --shadow-dark: 0 20px 40px rgba(0, 0, 0, 0.2);
            --shadow-dark-hover: 0 30px 60px rgba(0, 0, 0, 0.3);
            --radius-lg: 28px;
            --radius-md: 20px;
            --radius-sm: 12px;
            --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        [data-theme="dark"] {
            --primary: #FFFFFF;
            --secondary: #F1F5F9;
            --light: #0F172A;
            --light-secondary: #1E293B;
            --card-bg: var(--card-bg-dark);
            --text-primary: #FFFFFF;
            --text-secondary: #CBD5E1;
            --text-tertiary: #94A3B8;
            --border: var(--border-dark);
            --shadow: var(--shadow-dark);
            --shadow-hover: var(--shadow-dark-hover);
            --glass: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--light);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            transition: background-color 0.5s ease;
            min-height: 100vh;
        }

        /* Particle Background */
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: var(--light);
        }

        /* Container Principal */
        .container {
            display: none;
            max-width: 1400px;
            margin: 0 auto;
            padding: 100px 20px 40px;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.6s ease forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .tutorial-modal-step {
            display: none;
        }

        .tutorial-modal-step.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        .nav-links a {
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 0;
        }

        .nav-links a:hover {
            color: var(--accent);
        }

        .nav-links a.active {
            color: var(--accent);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        .auth-tab {
            transition: var(--transition);
        }

        .auth-tab:not(.active) {
            background: none;
            color: var(--text-secondary);
        }

        .auth-tab:not(.active):hover {
            background: rgba(16, 185, 129, 0.1);
        }

        [data-theme="dark"] .theme-toggle__thumb {
            transform: translateX(30px);
        }
        .container.active {
            display: block;
        }

        /* Tela de Login/Cadastro */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            background: var(--light);
            position: relative;
            overflow: hidden;
        }

        .auth-container::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 800px;
            height: 800px;
            background: var(--accent-gradient);
            border-radius: 50%;
            opacity: 0.08;
            animation: float 20s ease-in-out infinite;
            filter: blur(80px);
        }

        .auth-box {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-lg);
            padding: 60px;
            width: 100%;
            max-width: 500px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            position: relative;
            z-index: 1;
            animation: slideInUp 0.6s ease;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            padding: 25px 60px;
            z-index: 1000;
            transition: var(--transition);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-bottom: 1px solid var(--border);
            display: none;
        }

        [data-theme="dark"] nav {
            background: rgba(15, 23, 42, 0.95);
        }

        nav.scrolled {
            padding: 20px 60px;
            box-shadow: var(--shadow);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Se√ß√£o Home/Inicial */
        .hero-section {
            text-align: center;
            padding: 40px 0;
            margin-bottom: 50px;
        }

        .hero-title {
            font-size: clamp(40px, 5vw, 56px);
            font-weight: 900;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            line-height: 1.1;
        }

        .hero-subtitle {
            font-size: clamp(18px, 2vw, 22px);
            color: var(--text-secondary);
            max-width: 800px;
            margin: 0 auto 40px;
            font-weight: 500;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 60px 0;
        }

        .feature-card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 40px;
            text-align: center;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .feature-card:hover {
            transform: translateY(-10px);
            border-color: var(--accent);
            box-shadow: var(--shadow-hover);
        }

        .feature-icon {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            background: var(--accent-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            color: white;
            margin: 0 auto 25px;
            transition: var(--transition);
        }

        .feature-card:hover .feature-icon {
            transform: rotate(15deg) scale(1.1);
        }

        /* Regras do Jogo */
        .rules-container {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 50px;
            margin: 60px 0;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
        }

        .rules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .rule-item {
            display: flex;
            align-items: flex-start;
            gap: 20px;
            padding: 25px;
            background: var(--light-secondary);
            border-radius: var(--radius-md);
            transition: var(--transition);
        }

        .rule-item:hover {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.05) 100%);
            transform: translateX(10px);
        }

        .rule-number {
            width: 40px;
            height: 40px;
            background: var(--accent-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 18px;
            flex-shrink: 0;
        }

        /* Sistema de Apostas Aprimorado */
        .betting-header {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .header-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 35px;
            text-align: center;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .header-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .jackpot-amount {
            font-size: clamp(36px, 4vw, 48px);
            font-weight: 900;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 15px 0;
        }

        .draw-timer {
            font-size: clamp(28px, 3vw, 36px);
            font-weight: 800;
            color: var(--accent);
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }

        /* Tipos de Aposta */
        .bet-types {
            display: flex;
            gap: 20px;
            margin-bottom: 40px;
            overflow-x: auto;
            padding: 10px 0;
        }

        .bet-type-btn {
            padding: 18px 30px;
            background: var(--light-secondary);
            border: 2px solid var(--border);
            border-radius: var(--radius-md);
            font-weight: 700;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .bet-type-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .bet-type-btn.active {
            background: var(--accent-gradient);
            color: white;
            border-color: transparent;
            box-shadow: 0 8px 24px rgba(16, 185, 129, 0.3);
        }

        /* Animais com Hover */
        .animals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 50px;
        }

        .animal-card {
            background: var(--card-bg);
            border: 2px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .animal-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.6s;
        }

        .animal-card:hover::before {
            left: 100%;
        }

        .animal-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: var(--accent);
            box-shadow: var(--shadow-hover);
        }

        .animal-card.selected {
            border-color: var(--accent);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.05) 100%);
            box-shadow: 0 8px 24px rgba(16, 185, 129, 0.2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 8px 24px rgba(16, 185, 129, 0.2); }
            50% { box-shadow: 0 8px 24px rgba(16, 185, 129, 0.4); }
            100% { box-shadow: 0 8px 24px rgba(16, 185, 129, 0.2); }
        }

        /* Painel de Apostas Aprimorado */
        .bet-panel {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 50px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            margin-bottom: 50px;
            position: relative;
            overflow: hidden;
        }

        .bet-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: var(--accent-gradient);
        }

        .quick-bets {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .quick-bet-btn {
            padding: 15px 25px;
            background: var(--light-secondary);
            border: 2px solid var(--border);
            border-radius: var(--radius-md);
            font-weight: 700;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quick-bet-btn:hover {
            background: var(--accent-gradient);
            color: white;
            border-color: transparent;
            transform: translateY(-3px);
        }

        .bet-amount-control {
            display: grid;
            grid-template-columns: repeat(4, 1fr) 2fr repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 40px;
        }

        .amount-btn {
            padding: 20px;
            border-radius: var(--radius-md);
            border: 2px solid var(--border);
            background: var(--light);
            color: var(--text-primary);
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .amount-btn:hover {
            border-color: var(--accent);
            transform: scale(1.05);
        }

        .amount-input-container {
            position: relative;
        }

        .amount-input {
            width: 100%;
            height: 100%;
            border: 2px solid var(--border);
            border-radius: var(--radius-md);
            background: var(--light);
            color: var(--text-primary);
            font-size: 24px;
            font-weight: 700;
            text-align: center;
            padding: 0 20px;
            transition: var(--transition);
        }

        .amount-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        /* Statistics Dashboard */
        .stats-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            margin: 50px 0;
        }

        .stat-card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 30px;
            text-align: center;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
            box-shadow: var(--shadow-hover);
        }

        .stat-value {
            font-size: 36px;
            font-weight: 900;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 10px 0;
        }

        /* Recent Winners */
        .winners-carousel {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 40px;
            margin: 50px 0;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .winner-item {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
            border-bottom: 1px solid var(--border);
            transition: var(--transition);
        }

        .winner-item:hover {
            background: var(--light-secondary);
        }

        /* Tutorial Steps */
        .tutorial-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin: 50px 0;
        }

        .tutorial-step {
            text-align: center;
            padding: 40px 30px;
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
            position: relative;
            transition: var(--transition);
        }

        .tutorial-step:hover {
            transform: translateY(-10px);
            border-color: var(--accent);
            box-shadow: var(--shadow-hover);
        }

        .step-number {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            background: var(--accent-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 18px;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        /* Notifications System */
        .notification {
            position: fixed;
            top: 100px;
            right: 20px;
            padding: 25px;
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            z-index: 9999;
            max-width: 350px;
            transform: translateX(120%);
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }

        .notification.success .notification-icon {
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent);
        }

        .notification.error .notification-icon {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .notification.warning .notification-icon {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .notification.info .notification-icon {
            background: rgba(59, 130, 246, 0.1);
            color: var(--info);
        }

        /* Progress Bar */
        .progress-bar {
            height: 6px;
            background: var(--light-secondary);
            border-radius: 3px;
            margin: 30px 0;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent-gradient);
            border-radius: 3px;
            width: 0%;
            transition: width 1s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            to {
                left: 100%;
            }
        }

        /* Confetti Effect */
        .confetti {
            position: fixed;
            width: 15px;
            height: 15px;
            background: var(--accent);
            top: 0;
            opacity: 0;
            z-index: 9998;
        }

        /* Loading Spinner */
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--light-secondary);
            border-top: 5px solid var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 250px;
            background: var(--card-bg);
            color: var(--text-primary);
            text-align: center;
            padding: 15px;
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: var(--shadow);
            font-size: 14px;
            font-weight: 400;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* Anima√ß√£o de Celebra√ß√£o */
        @keyframes celebrate {
            0% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.2) rotate(15deg); }
            50% { transform: scale(1.1) rotate(-15deg); }
            75% { transform: scale(1.2) rotate(15deg); }
            100% { transform: scale(1) rotate(0deg); }
        }

        .celebrate {
            animation: celebrate 0.8s ease;
        }

        /* Modal de Resultado */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 50px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 25px;
            right: 25px;
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 8px;
            border-radius: var(--radius-sm);
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
        }

        /* Settings Tabs */
        .settings-tabs {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 30px;
        }

        .settings-tab {
            padding: 18px 24px;
            border: none;
            background: none;
            border-radius: var(--radius-md);
            text-align: left;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .settings-tab:hover {
            background: var(--light-secondary);
            color: var(--text-primary);
        }

        .settings-tab.active {
            background: var(--accent-gradient);
            color: white;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .settings-content {
            display: none;
        }

        .settings-content.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Amount Options */
        .amount-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .amount-option {
            padding: 20px;
            background: var(--light-secondary);
            border: 2px solid var(--border);
            border-radius: var(--radius-md);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .amount-option:hover {
            border-color: var(--accent);
        }

        .amount-option.selected {
            background: var(--accent-gradient);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        /* Payment Methods */
        .payment-methods {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .payment-method {
            background: var(--light-secondary);
            border: 2px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .payment-method:hover {
            border-color: var(--accent);
            transform: translateY(-5px);
        }

        .payment-method.selected {
            border-color: var(--accent);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.05) 100%);
        }

        /* Responsividade */
        @media (max-width: 1200px) {
            .bet-amount-control {
                grid-template-columns: repeat(3, 1fr);
            }

            .animals-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            }
        }

        @media (max-width: 992px) {
            nav {
                padding: 20px 30px;
            }

            .hero-title {
                font-size: 42px;
            }

            .betting-header {
                grid-template-columns: 1fr;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .bet-amount-control {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .auth-box {
                padding: 40px 30px;
            }

            .bet-panel {
                padding: 30px;
            }

            .animals-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .rules-grid {
                grid-template-columns: 1fr;
            }

            .tutorial-steps {
                grid-template-columns: 1fr;
            }

            .stats-dashboard {
                grid-template-columns: repeat(2, 1fr);
            }

            .amount-options {
                grid-template-columns: repeat(2, 1fr);
            }

            .payment-methods {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .hero-title {
                font-size: 36px;
            }

            .animal-card {
                padding: 20px;
            }

            .bet-type-btn {
                padding: 15px 20px;
                font-size: 14px;
            }

            .quick-bet-btn {
                padding: 12px 20px;
                font-size: 14px;
            }

            .amount-btn {
                padding: 15px;
                font-size: 18px;
            }

            .amount-input {
                font-size: 20px;
            }

            .amount-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
<!-- Tela de Login/Cadastro -->
<div id="authScreen" class="auth-container">
    <div class="auth-box">
        <div class="auth-header">
            <div class="auth-logo" style="font-size: 48px; font-weight: 900; background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 20px; display: flex; align-items: center; justify-content: center; gap: 15px;">
                <i class="fas fa-dice"></i>
                MarcosBet
            </div>
            <p class="auth-subtitle" style="color: var(--text-secondary); font-size: 18px; margin-bottom: 40px;">Aposta Segura - Divers√£o Garantida üéØ</p>
        </div>

        <div class="auth-tabs" style="display: flex; gap: 10px; margin-bottom: 40px; background: var(--light-secondary); padding: 8px; border-radius: var(--radius-md);">
            <button class="auth-tab active" data-tab="login" style="flex: 1; padding: 16px; border: none; background: var(--accent-gradient); color: white; border-radius: var(--radius-sm); font-weight: 600; cursor: pointer; transition: var(--transition);">Login</button>
            <button class="auth-tab" data-tab="register" style="flex: 1; padding: 16px; border: none; background: none; border-radius: var(--radius-sm); font-weight: 600; color: var(--text-secondary); cursor: pointer; transition: var(--transition);">Cadastro</button>
        </div>

        <form id="loginForm" class="auth-form active">
            <div class="form-group" style="margin-bottom: 24px;">
                <label for="loginUsername" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px;">Usu√°rio</label>
                <input type="text" id="loginUsername" class="form-control" placeholder="Digite seu usu√°rio" required style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; transition: var(--transition);">
            </div>

            <div class="form-group" style="margin-bottom: 24px;">
                <label for="loginPassword" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px;">Senha</label>
                <input type="password" id="loginPassword" class="form-control" placeholder="Digite sua senha" required style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; transition: var(--transition);">
            </div>

            <button type="submit" class="btn btn-primary" style="padding: 18px 32px; border-radius: var(--radius-md); border: none; background: var(--accent-gradient); color: white; font-weight: 700; font-size: 16px; cursor: pointer; transition: var(--transition); display: flex; align-items: center; justify-content: center; gap: 10px; width: 100%;">
                <i class="fas fa-sign-in-alt"></i> Entrar
            </button>

            <div class="auth-footer" style="text-align: center; margin-top: 30px; color: var(--text-secondary); font-size: 14px;">
                <p>Usu√°rio de teste: <strong>kayua</strong> | Senha: <strong>12345</strong></p>
                <p style="margin-top: 10px;">B√¥nus de boas-vindas: <strong>R$ 50,00</strong></p>
            </div>
        </form>

        <form id="registerForm" class="auth-form" style="display: none;">
            <div class="form-group" style="margin-bottom: 24px;">
                <label for="registerUsername" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px;">Usu√°rio</label>
                <input type="text" id="registerUsername" class="form-control" placeholder="Escolha um usu√°rio" required style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; transition: var(--transition);">
            </div>

            <div class="form-group" style="margin-bottom: 24px;">
                <label for="registerEmail" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px;">Email</label>
                <input type="email" id="registerEmail" class="form-control" placeholder="Digite seu email" required style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; transition: var(--transition);">
            </div>

            <div class="form-group" style="margin-bottom: 24px;">
                <label for="registerPassword" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px;">Senha</label>
                <input type="password" id="registerPassword" class="form-control" placeholder="Crie uma senha" required style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; transition: var(--transition);">
            </div>

            <div class="form-group" style="margin-bottom: 24px;">
                <label for="registerConfirmPassword" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px;">Confirmar Senha</label>
                <input type="password" id="registerConfirmPassword" class="form-control" placeholder="Confirme sua senha" required style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; transition: var(--transition);">
            </div>

            <button type="submit" class="btn btn-primary" style="padding: 18px 32px; border-radius: var(--radius-md); border: none; background: var(--accent-gradient); color: white; font-weight: 700; font-size: 16px; cursor: pointer; transition: var(--transition); display: flex; align-items: center; justify-content: center; gap: 10px; width: 100%;">
                <i class="fas fa-user-plus"></i> Criar Conta
            </button>
        </form>
    </div>
</div>

<!-- Navigation -->
<nav id="navbar" style="display: none;">
    <div class="nav-container">
        <a href="#" class="logo" onclick="showSection('home'); return false;" style="font-size: 32px; font-weight: 900; letter-spacing: -0.5px; color: var(--primary); display: flex; align-items: center; gap: 12px; transition: var(--transition); text-decoration: none;">
            <div class="logo-icon" style="background: var(--accent-gradient); width: 44px; height: 44px; border-radius: 14px; display: flex; align-items: center; justify-content: center; color: white; font-size: 22px; transition: var(--transition);">
                <i class="fas fa-dice"></i>
            </div>
            Banca Marcos
        </a>

        <ul class="nav-links" style="display: flex; gap: 40px; list-style: none; align-items: center;">
            <li><a href="#" onclick="showSection('home'); return false;"><i class="fas fa-home"></i> In√≠cio</a></li>
            <li><a href="#" onclick="showSection('betting'); return false;"><i class="fas fa-coins"></i> Apostas</a></li>
            <li><a href="#" onclick="showSection('results'); return false;"><i class="fas fa-trophy"></i> Resultados</a></li>
            <li><a href="#" onclick="showPromotions(); return false;"><i class="fas fa-gift"></i> Promo</a></li>
            <li><a href="#" onclick="showSection('settings'); return false;"><i class="fas fa-cog"></i> Configura√ß√µes</a></li>
            <li><a href="#" onclick="showSection('help'); return false;"><i class="fas fa-question-circle"></i> Ajuda</a></li>
        </ul>

        <div class="user-info" style="display: flex; align-items: center; gap: 20px;">
            <div class="user-balance" style="background: var(--accent-gradient); color: white; padding: 10px 20px; border-radius: var(--radius-md); font-weight: 700; display: flex; align-items: center; gap: 10px; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);">
                <i class="fas fa-wallet"></i>
                <span id="userBalance">R$ 0,00</span>
            </div>

            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme" style="width: 64px; height: 32px; border-radius: 50px; background: var(--light-secondary); border: 2px solid var(--border); cursor: pointer; position: relative; padding: 0; transition: var(--transition); display: flex; align-items: center; justify-content: center;">
                <div class="theme-toggle__container" style="width: 100%; height: 100%; position: relative; display: flex; align-items: center; justify-content: space-between; padding: 0 8px;">
                    <svg class="theme-toggle__sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width: 18px; height: 18px; color: var(--text-secondary); transition: var(--transition); z-index: 2;">
                        <circle cx="12" cy="12" r="5" fill="currentColor"/>
                        <line x1="12" y1="1" x2="12" y2="4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <line x1="12" y1="20" x2="12" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <line x1="4.22" y1="4.22" x2="6.34" y2="6.34" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <line x1="17.66" y1="17.66" x2="19.78" y2="19.78" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <line x1="1" y1="12" x2="4" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <line x1="20" y1="12" x2="23" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <line x1="4.22" y1="19.78" x2="6.34" y2="17.66" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <line x1="17.66" y1="6.34" x2="19.78" y2="4.22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <svg class="theme-toggle__moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width: 18px; height: 18px; color: var(--text-secondary); transition: var(--transition); z-index: 2;">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" fill="currentColor"/>
                    </svg>
                    <div class="theme-toggle__thumb" style="position: absolute; left: 4px; width: 24px; height: 24px; background: var(--accent-gradient); border-radius: 50%; transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); z-index: 1; box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);"></div>
                </div>
            </button>

            <button class="btn btn-secondary" onclick="logout()" style="padding: 12px 24px; border-radius: var(--radius-md); border: 2px solid var(--border); background: var(--light-secondary); color: var(--text-primary); font-weight: 600; cursor: pointer; transition: var(--transition); display: flex; align-items: center; gap: 8px;">
                <i class="fas fa-sign-out-alt"></i> Sair
            </button>
        </div>
    </div>
</nav>

<!-- Se√ß√£o Home/Inicial -->
<div id="homeSection" class="container">
    <div class="hero-section">
        <h1 class="hero-title">Banca do Marcos üéØ</h1>
        <p class="hero-subtitle">A casa de apostas mais segura e divertida do Brasil! Jogue com responsabilidade e tenha a chance de ganhar grandes pr√™mios.</p>

        <div style="display: flex; gap: 20px; justify-content: center; margin-top: 40px; flex-wrap: wrap;">
            <button class="btn btn-primary" onclick="showSection('betting')" style="padding: 18px 42px; border-radius: var(--radius-md); border: none; background: var(--accent-gradient); color: white; font-weight: 700; font-size: 16px; cursor: pointer; transition: var(--transition); display: inline-flex; align-items: center; gap: 12px; box-shadow: 0 8px 24px rgba(16, 185, 129, 0.3);">
                <i class="fas fa-play-circle"></i> Come√ßar a Apostar
            </button>
            <button class="btn btn-secondary" onclick="showSection('tutorial')" style="padding: 18px 42px; border-radius: var(--radius-md); border: 2px solid var(--border); background: var(--light-secondary); color: var(--text-primary); font-weight: 700; font-size: 16px; cursor: pointer; transition: var(--transition); display: inline-flex; align-items: center; gap: 12px;">
                <i class="fas fa-graduation-cap"></i> Tutorial Completo
            </button>
        </div>
    </div>

    <div class="features-grid">
        <div class="feature-card">
            <div class="feature-icon">
                <i class="fas fa-shield-alt"></i>
            </div>
            <h3 style="font-size: 24px; margin-bottom: 15px; color: var(--text-primary);">100% Seguro</h3>
            <p style="color: var(--text-secondary);">Plataforma certificada e protegida com criptografia de ponta.</p>
        </div>

        <div class="feature-card">
            <div class="feature-icon">
                <i class="fas fa-bolt"></i>
            </div>
            <h3 style="font-size: 24px; margin-bottom: 15px; color: var(--text-primary);">Dep√≥sito R√°pido</h3>
            <p style="color: var(--text-secondary);">Dep√≥sitos processados em at√© 2 minutos via PIX.</p>
        </div>

        <div class="feature-card">
            <div class="feature-icon">
                <i class="fas fa-gift"></i>
            </div>
            <h3 style="font-size: 24px; margin-bottom: 15px; color: var(--text-primary);">B√¥nus Di√°rios</h3>
            <p style="color: var(--text-secondary);">Receba b√¥nus exclusivos todos os dias para apostar mais.</p>
        </div>
    </div>

    <div class="rules-container">
        <h2 style="font-size: 36px; margin-bottom: 30px; color: var(--text-primary); text-align: center;">üìú Regras do Jogo do Bicho</h2>

        <div class="rules-grid">
            <div class="rule-item">
                <div class="rule-number">1</div>
                <div>
                    <h4 style="margin-bottom: 8px; color: var(--text-primary);">Escolha do Animal</h4>
                    <p style="color: var(--text-secondary); font-size: 14px;">Selecione um ou mais animais entre as 25 op√ß√µes dispon√≠veis.</p>
                </div>
            </div>

            <div class="rule-item">
                <div class="rule-number">2</div>
                <div>
                    <h4 style="margin-bottom: 8px; color: var(--text-primary);">Valor da Aposta</h4>
                    <p style="color: var(--text-secondary); font-size: 14px;">Aposte de R$ 1 a R$ 1000 por animal selecionado.</p>
                </div>
            </div>

            <div class="rule-item">
                <div class="rule-number">3</div>
                <div>
                    <h4 style="margin-bottom: 8px; color: var(--text-primary);">Sorteios</h4>
                    <p style="color: var(--text-secondary); font-size: 14px;">Sorteios a cada 5 minutos, 24 horas por dia, 7 dias por semana.</p>
                </div>
            </div>

            <div class="rule-item">
                <div class="rule-number">4</div>
                <div>
                    <h4 style="margin-bottom: 8px; color: var(--text-primary);">Pagamento</h4>
                    <p style="color: var(--text-secondary); font-size: 14px;">Ganhos pagos instantaneamente na sua carteira Banco do Marcos.</p>
                </div>
            </div>

            <div class="rule-item">
                <div class="rule-number">5</div>
                <div>
                    <h4 style="margin-bottom: 8px; color: var(--text-primary);">Odds</h4>
                    <p style="color: var(--text-secondary); font-size: 14px;">Cada animal paga 18x o valor apostado em caso de vit√≥ria.</p>
                </div>
            </div>

            <div class="rule-item">
                <div class="rule-number">6</div>
                <div>
                    <h4 style="margin-bottom: 8px; color: var(--text-primary);">Responsabilidade</h4>
                    <p style="color: var(--text-secondary); font-size: 14px;">Jogue com responsabilidade. Estabele√ßa limites de gastos.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="tutorial-steps">
        <div class="tutorial-step">
            <div class="step-number">1</div>
            <h3 style="margin-bottom: 15px; color: var(--text-primary);">Crie sua Conta</h3>
            <p style="color: var(--text-secondary);">Registre-se em menos de 1 minuto e receba R$ 50 de b√¥nus.</p>
        </div>

        <div class="tutorial-step">
            <div class="step-number">2</div>
            <h3 style="margin-bottom: 15px; color: var(--text-primary);">Fa√ßa um Dep√≥sito</h3>
            <p style="color: var(--text-secondary);">Use PIX, cart√£o ou boleto para adicionar cr√©ditos √† sua conta.</p>
        </div>

        <div class="tutorial-step">
            <div class="step-number">3</div>
            <h3 style="margin-bottom: 15px; color: var(--text-primary);">Escolha seus Animais</h3>
            <p style="color: var(--text-secondary);">Selecione os animais que voc√™ acredita que ser√£o sorteados.</p>
        </div>

        <div class="tutorial-step">
            <div class="step-number">4</div>
            <h3 style="margin-bottom: 15px; color: var(--text-primary);">Aguarde o Sorteio</h3>
            <p style="color: var(--text-secondary);">Os sorteios acontecem a cada 5 minutos. Boa sorte!</p>
        </div>
    </div>
</div>

<!-- Se√ß√£o de Apostas -->
<div id="bettingSection" class="container">
    <div style="display: flex; justify-content: flex-end; margin-bottom: 20px;">
        <button class="btn btn-secondary" onclick="showStats()" style="padding: 12px 24px; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-chart-line"></i> Ver Estat√≠sticas Detalhadas
        </button>
    </div>
    <div class="betting-header">
        <div class="header-card">
            <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px; font-weight: 600;">PR√äMIO ACUMULADO</div>
            <div class="jackpot-amount" id="jackpotAmount">R$ 25.847,50</div>
            <div style="font-size: 12px; color: var(--text-tertiary);">+12% desde ontem</div>
        </div>

        <div class="header-card">
            <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px; font-weight: 600;">PR√ìXIMO SORTEIO</div>
            <div class="draw-timer" id="drawTimer">04:32</div>
            <div style="font-size: 12px; color: var(--text-tertiary);">Sorteio #202412345</div>
        </div>

        <div class="header-card">
            <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px; font-weight: 600;">JOGADORES ONLINE</div>
            <div style="font-size: 32px; font-weight: 800; color: var(--accent); margin: 15px 0;">1,247</div>
            <div style="font-size: 12px; color: var(--text-tertiary);">Apostando agora</div>
        </div>
    </div>

    <div class="bet-types">
        <button class="bet-type-btn active" onclick="selectBetType('simple')">
            <i class="fas fa-star"></i> Aposta Simples
        </button>
        <button class="bet-type-btn" onclick="selectBetType('multiple')">
            <i class="fas fa-layer-group"></i> Aposta M√∫ltipla
        </button>
        <button class="bet-type-btn" onclick="selectBetType('group')">
            <i class="fas fa-users"></i> Aposta em Grupo
        </button>
        <button class="bet-type-btn" onclick="selectBetType('dezena')">
            <i class="fas fa-hashtag"></i> Dezena
        </button>
        <button class="bet-type-btn" onclick="selectBetType('centena')">
            <i class="fas fa-hashtag"></i> Centena
        </button>
    </div>

    <div class="animals-grid" id="animalsGrid">
        <!-- Animais ser√£o gerados por JavaScript -->
    </div>

    <div class="bet-panel">
        <h3 style="margin-bottom: 25px; color: var(--text-primary); font-size: 24px;">Painel de Apostas</h3>

        <div class="quick-bets">
            <button class="quick-bet-btn" onclick="setQuickBet(1)">
                <i class="fas fa-bolt"></i> R$ 1
            </button>
            <button class="quick-bet-btn" onclick="setQuickBet(5)">
                <i class="fas fa-bolt"></i> R$ 5
            </button>
            <button class="quick-bet-btn" onclick="setQuickBet(10)">
                <i class="fas fa-bolt"></i> R$ 10
            </button>
            <button class="quick-bet-btn" onclick="setQuickBet(25)">
                <i class="fas fa-bolt"></i> R$ 25
            </button>
            <button class="quick-bet-btn" onclick="setQuickBet(50)">
                <i class="fas fa-bolt"></i> R$ 50
            </button>
            <button class="quick-bet-btn" onclick="setQuickBet(100)">
                <i class="fas fa-bolt"></i> R$ 100
            </button>
        </div>

        <div class="bet-amount-control">
            <button class="amount-btn" onclick="adjustBet(-100)">-100</button>
            <button class="amount-btn" onclick="adjustBet(-50)">-50</button>
            <button class="amount-btn" onclick="adjustBet(-10)">-10</button>
            <button class="amount-btn" onclick="adjustBet(-5)">-5</button>

            <div class="amount-input-container">
                <input type="number" id="betAmount" class="amount-input" value="10" min="1" max="1000">
            </div>

            <button class="amount-btn" onclick="adjustBet(5)">+5</button>
            <button class="amount-btn" onclick="adjustBet(10)">+10</button>
            <button class="amount-btn" onclick="adjustBet(50)">+50</button>
            <button class="amount-btn" onclick="adjustBet(100)">+100</button>
        </div>

        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-top: 40px;">
            <button class="btn btn-primary" onclick="placeBet()" style="padding: 22px; font-size: 18px; font-weight: 700;">
                <i class="fas fa-coins"></i> APOSTAR R$ <span id="currentBetAmount">10</span>
            </button>
            <button class="btn btn-secondary" onclick="clearBets()" style="padding: 22px; font-size: 18px; font-weight: 700; background: var(--light-secondary); color: var(--text-primary); border: 2px solid var(--border);">
                <i class="fas fa-trash"></i> LIMPAR
            </button>
        </div>
    </div>

    <div class="stats-dashboard">
        <div class="stat-card">
            <div style="font-size: 14px; color: var(--text-secondary);">TOTAL APOSTADO</div>
            <div class="stat-value" id="totalBetAmount">R$ 0</div>
            <div style="font-size: 12px; color: var(--text-tertiary);">Nesta sess√£o</div>
        </div>

        <div class="stat-card">
            <div style="font-size: 14px; color: var(--text-secondary);">GANHO POTENCIAL</div>
            <div class="stat-value" id="potentialWin">R$ 0</div>
            <div style="font-size: 12px; color: var(--text-tertiary);">Se ganhar</div>
        </div>

        <div class="stat-card">
            <div style="font-size: 14px; color: var(--text-secondary);">ANIMAIS SELECIONADOS</div>
            <div class="stat-value" id="selectedAnimalsCount">0</div>
            <div style="font-size: 12px; color: var(--text-tertiary);">De 25 dispon√≠veis</div>
        </div>

        <div class="stat-card">
            <div style="font-size: 14px; color: var(--text-secondary);">CHANCE DE GANHAR</div>
            <div class="stat-value" id="winChance">0%</div>
            <div style="font-size: 12px; color: var(--text-tertiary);">Por aposta</div>
        </div>
    </div>

    <div id="currentBets" class="winners-carousel">
        <h3 style="margin-bottom: 25px; color: var(--text-primary); font-size: 24px;">Suas Apostas Atuais</h3>
        <div id="betsList" style="max-height: 400px; overflow-y: auto;">
            <!-- Apostas ser√£o listadas aqui -->
        </div>
    </div>
</div>

<!-- Se√ß√£o de Resultados -->
<div id="resultsSection" class="container">
    <div class="hero-section">
        <h1 class="hero-title">üèÜ Resultados</h1>
        <p class="hero-subtitle">Acompanhe os √∫ltimos sorteios e veja se voc√™ foi um dos ganhadores!</p>
    </div>

    <div class="winners-carousel">
        <h2 style="margin-bottom: 30px; color: var(--text-primary);">√öltimos Sorteios</h2>
        <div id="recentDraws">
            <!-- Sorteios recentes ser√£o carregados aqui -->
        </div>
    </div>

    <div class="winners-carousel" style="margin-top: 40px;">
        <h2 style="margin-bottom: 30px; color: var(--text-primary);">Maiores Ganhadores</h2>
        <div id="topWinners">
            <!-- Top ganhadores ser√£o carregados aqui -->
        </div>
    </div>
</div>

<!-- Se√ß√£o de Configura√ß√µes -->
<div id="settingsSection" class="container">
    <div class="hero-section">
        <h1 class="hero-title">‚öôÔ∏è Configura√ß√µes</h1>
        <p class="hero-subtitle">Personalize sua experi√™ncia e gerencie sua conta.</p>
    </div>

    <div style="display: grid; grid-template-columns: 300px 1fr; gap: 40px;">
        <div style="background: var(--card-bg); border-radius: var(--radius-lg); padding: 30px; border: 1px solid var(--border); box-shadow: var(--shadow); height: fit-content;">
            <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 30px;">
                <div style="width: 80px; height: 80px; border-radius: 50%; background: var(--accent-gradient); display: flex; align-items: center; justify-content: center; font-size: 36px; color: white; box-shadow: 0 8px 24px rgba(16, 185, 129, 0.3);">
                    <i class="fas fa-user"></i>
                </div>
                <div>
                    <h3 id="profileUsername" style="font-size: 20px; margin-bottom: 5px;">Usu√°rio</h3>
                    <p style="color: var(--text-secondary); font-size: 14px;">N√≠vel: <span id="userLevel">Iniciante</span></p>
                </div>
            </div>

            <div style="margin-bottom: 30px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span style="font-size: 14px; color: var(--text-secondary);">Progresso para Pr√≥ximo N√≠vel</span>
                    <span style="font-size: 14px; color: var(--accent); font-weight: 600;" id="levelProgress">25%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="levelProgressBar" style="width: 25%;"></div>
                </div>
            </div>

            <div class="settings-tabs">
                <button class="settings-tab active" onclick="showSettingsTab('profile')">
                    <i class="fas fa-user"></i> Perfil
                </button>
                <button class="settings-tab" onclick="showSettingsTab('account')">
                    <i class="fas fa-wallet"></i> Saldo & Dep√≥sitos
                </button>
                <button class="settings-tab" onclick="showSettingsTab('security')">
                    <i class="fas fa-shield-alt"></i> Seguran√ßa
                </button>
                <button class="settings-tab" onclick="showSettingsTab('notifications')">
                    <i class="fas fa-bell"></i> Notifica√ß√µes
                </button>
                <button class="settings-tab" onclick="showSettingsTab('history')">
                    <i class="fas fa-history"></i> Hist√≥rico
                </button>
            </div>
        </div>

        <div style="background: var(--card-bg); border-radius: var(--radius-lg); padding: 40px; border: 1px solid var(--border); box-shadow: var(--shadow);">
            <div id="profileTab" class="settings-content active">
                <h2 style="font-size: 32px; margin-bottom: 30px; color: var(--text-primary);">Perfil do Usu√°rio</h2>
                <div style="display: flex; align-items: center; gap: 30px; margin-bottom: 40px;">
                    <div style="width: 120px; height: 120px; border-radius: 50%; background: var(--accent-gradient); display: flex; align-items: center; justify-content: center; font-size: 48px; color: white; box-shadow: 0 8px 24px rgba(16, 185, 129, 0.3);">
                        <i class="fas fa-user"></i>
                    </div>
                    <div>
                        <h3 id="profileUsername2" style="font-size: 24px; margin-bottom: 10px;">Usu√°rio</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 5px;" id="profileEmail">email@exemplo.com</p>
                        <p style="color: var(--text-secondary); margin-bottom: 5px;">Membro desde: <span id="memberSince">2024</span></p>
                        <p style="color: var(--text-secondary); margin-bottom: 5px;">Total de apostas: <span id="totalBets">0</span></p>
                        <p style="color: var(--text-secondary);">Vit√≥rias: <span id="totalWins">0</span></p>
                    </div>
                </div>

                <div style="margin-bottom: 24px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px;">Nome Completo</label>
                    <input type="text" id="profileName" style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; transition: var(--transition);" placeholder="Digite seu nome">
                </div>

                <div style="margin-bottom: 24px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px;">Telefone</label>
                    <input type="tel" id="profilePhone" style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; transition: var(--transition);" placeholder="(11) 99999-9999">
                </div>

                <button class="btn btn-primary" onclick="updateProfile()" style="padding: 18px 32px; border-radius: var(--radius-md); border: none; background: var(--accent-gradient); color: white; font-weight: 700; font-size: 16px; cursor: pointer; transition: var(--transition); display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-save"></i> Salvar Altera√ß√µes
                </button>
            </div>

            <div id="accountTab" class="settings-content">
                <h2 style="font-size: 32px; margin-bottom: 30px; color: var(--text-primary);">Saldo & Dep√≥sitos</h2>

                <div style="text-align: center; margin-bottom: 40px;">
                    <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 10px;">SALDO ATUAL</div>
                    <div id="accountBalance" style="font-size: 48px; font-weight: 900; color: var(--accent);">R$ 0,00</div>
                </div>

                <h3 style="margin-bottom: 20px; color: var(--text-primary);">Adicionar Cr√©ditos</h3>
                <div class="amount-options">
                    <div class="amount-option" onclick="selectAmount(10)">
                        <div style="font-size: 20px; font-weight: 800; margin-bottom: 5px;">R$ 10</div>
                        <div style="font-size: 12px; color: var(--accent); font-weight: 600;">+R$ 1 b√¥nus</div>
                    </div>
                    <div class="amount-option" onclick="selectAmount(25)">
                        <div style="font-size: 20px; font-weight: 800; margin-bottom: 5px;">R$ 25</div>
                        <div style="font-size: 12px; color: var(--accent); font-weight: 600;">+R$ 3 b√¥nus</div>
                    </div>
                    <div class="amount-option" onclick="selectAmount(50)">
                        <div style="font-size: 20px; font-weight: 800; margin-bottom: 5px;">R$ 50</div>
                        <div style="font-size: 12px; color: var(--accent); font-weight: 600;">+R$ 7 b√¥nus</div>
                    </div>
                    <div class="amount-option" onclick="selectAmount(100)">
                        <div style="font-size: 20px; font-weight: 800; margin-bottom: 5px;">R$ 100</div>
                        <div style="font-size: 12px; color: var(--accent); font-weight: 600;">+R$ 15 b√¥nus</div>
                    </div>
                    <div class="amount-option" onclick="selectAmount(250)">
                        <div style="font-size: 20px; font-weight: 800; margin-bottom: 5px;">R$ 250</div>
                        <div style="font-size: 12px; color: var(--accent); font-weight: 600;">+R$ 40 b√¥nus</div>
                    </div>
                    <div class="amount-option" onclick="selectAmount(500)">
                        <div style="font-size: 20px; font-weight: 800; margin-bottom: 5px;">R$ 500</div>
                        <div style="font-size: 12px; color: var(--accent); font-weight: 600;">+R$ 100 b√¥nus</div>
                    </div>
                </div>

                <div style="margin-bottom: 30px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px;">Ou digite um valor</label>
                    <input type="number" id="customAmount" style="width: 200px; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; transition: var(--transition);" placeholder="R$ 0,00" min="1" max="1000">
                </div>

                <h3 style="margin: 30px 0 20px; color: var(--text-primary);">M√©todo de Pagamento</h3>
                <div class="payment-methods">
                    <div class="payment-method" onclick="selectPayment('pix')">
                        <div style="font-size: 48px; margin-bottom: 20px; color: var(--accent);">
                            <i class="fas fa-qrcode"></i>
                        </div>
                        <div style="font-size: 18px; font-weight: 700; margin-bottom: 10px;">PIX</div>
                        <p style="color: var(--text-secondary); font-size: 14px;">Instant√¢neo</p>
                    </div>

                    <div class="payment-method" onclick="selectPayment('credit')">
                        <div style="font-size: 48px; margin-bottom: 20px; color: var(--accent);">
                            <i class="far fa-credit-card"></i>
                        </div>
                        <div style="font-size: 18px; font-weight: 700; margin-bottom: 10px;">Cart√£o de Cr√©dito</div>
                        <p style="color: var(--text-secondary); font-size: 14px;">Visa, Mastercard</p>
                    </div>

                    <div class="payment-method" onclick="selectPayment('bank')">
                        <div style="font-size: 48px; margin-bottom: 20px; color: var(--accent);">
                            <i class="fas fa-university"></i>
                        </div>
                        <div style="font-size: 18px; font-weight: 700; margin-bottom: 10px;">Transfer√™ncia</div>
                        <p style="color: var(--text-secondary); font-size: 14px;">TED/DOC</p>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="addFunds()" style="margin-top: 30px; padding: 18px 32px; border-radius: var(--radius-md); border: none; background: var(--accent-gradient); color: white; font-weight: 700; font-size: 16px; cursor: pointer; transition: var(--transition); display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-plus-circle"></i> Adicionar Cr√©ditos
                </button>
            </div>

            <div id="securityTab" class="settings-content">
                <h2 style="font-size: 32px; margin-bottom: 30px; color: var(--text-primary);">Seguran√ßa</h2>

                <div style="margin-bottom: 24px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px;">Senha Atual</label>
                    <input type="password" id="currentPassword" style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; transition: var(--transition);">
                </div>

                <div style="margin-bottom: 24px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px;">Nova Senha</label>
                    <input type="password" id="newPassword" style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; transition: var(--transition);">
                </div>

                <div style="margin-bottom: 24px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px;">Confirmar Nova Senha</label>
                    <input type="password" id="confirmNewPassword" style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; transition: var(--transition);">
                </div>

                <button class="btn btn-primary" onclick="changePassword()" style="padding: 18px 32px; border-radius: var(--radius-md); border: none; background: var(--accent-gradient); color: white; font-weight: 700; font-size: 16px; cursor: pointer; transition: var(--transition); display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-key"></i> Alterar Senha
                </button>

                <div style="margin-top: 40px; padding: 20px; background: rgba(239, 68, 68, 0.1); border-radius: var(--radius-md);">
                    <h3 style="color: var(--danger); margin-bottom: 15px;"><i class="fas fa-exclamation-triangle"></i> Zona de Perigo</h3>
                    <button class="btn btn-danger" onclick="deleteAccount()" style="padding: 15px 30px; border-radius: var(--radius-md); border: none; background: var(--danger); color: white; font-weight: 700; font-size: 16px; cursor: pointer; transition: var(--transition); display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-trash"></i> Excluir Minha Conta
                    </button>
                </div>
            </div>

            <div id="notificationsTab" class="settings-content">
                <h2 style="font-size: 32px; margin-bottom: 30px; color: var(--text-primary);">Notifica√ß√µes</h2>

                <div style="margin-bottom: 24px;">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="notifications" checked style="width: 20px; height: 20px;">
                        <span style="font-weight: 600; color: var(--text-primary);">Receber notifica√ß√µes de sorteios</span>
                    </label>
                </div>

                <div style="margin-bottom: 24px;">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="promotions" checked style="width: 20px; height: 20px;">
                        <span style="font-weight: 600; color: var(--text-primary);">Receber promo√ß√µes e ofertas</span>
                    </label>
                </div>

                <div style="margin-bottom: 24px;">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="soundEffects" style="width: 20px; height: 20px;">
                        <span style="font-weight: 600; color: var(--text-primary);">Efeitos sonoros</span>
                    </label>
                </div>

                <div style="margin-bottom: 24px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px;">Idioma</label>
                    <select id="language" style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; transition: var(--transition);">
                        <option value="pt">Portugu√™s (Brasil)</option>
                        <option value="en">English</option>
                        <option value="es">Espa√±ol</option>
                    </select>
                </div>

                <button class="btn btn-primary" onclick="savePreferences()" style="padding: 18px 32px; border-radius: var(--radius-md); border: none; background: var(--accent-gradient); color: white; font-weight: 700; font-size: 16px; cursor: pointer; transition: var(--transition); display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-save"></i> Salvar Prefer√™ncias
                </button>
            </div>

            <div id="historyTab" class="settings-content">
                <h2 style="font-size: 32px; margin-bottom: 30px; color: var(--text-primary);">Hist√≥rico de Apostas</h2>
                <div id="betHistory" style="max-height: 500px; overflow-y: auto;">
                    <!-- Hist√≥rico ser√° carregado aqui -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Se√ß√£o de Ajuda -->
<div id="helpSection" class="container">
    <div class="hero-section">
        <h1 class="hero-title">‚ùì Ajuda</h1>
        <p class="hero-subtitle">Encontre respostas para suas d√∫vidas frequentes e aprenda a usar a plataforma.</p>
    </div>

    <div class="rules-container">
        <h2 style="font-size: 36px; margin-bottom: 30px; color: var(--text-primary); text-align: center;">Perguntas Frequentes</h2>

        <div class="rules-grid">
            <div class="rule-item">
                <div class="rule-number">1</div>
                <div>
                    <h4 style="margin-bottom: 8px; color: var(--text-primary);">Como fa√ßo para apostar?</h4>
                    <p style="color: var(--text-secondary); font-size: 14px;">Selecione um ou mais animais, defina o valor da aposta e clique em "Apostar".</p>
                </div>
            </div>

            <div class="rule-item">
                <div class="rule-number">2</div>
                <div>
                    <h4 style="margin-bottom: 8px; color: var(--text-primary);">Quando ocorrem os sorteios?</h4>
                    <p style="color: var(--text-secondary); font-size: 14px;">Sorteios a cada 5 minutos, 24 horas por dia, 7 dias por semana.</p>
                </div>
            </div>

            <div class="rule-item">
                <div class="rule-number">3</div>
                <div>
                    <h4 style="margin-bottom: 8px; color: var(--text-primary);">Como recebo meus ganhos?</h4>
                    <p style="color: var(--text-secondary); font-size: 14px;">Os ganhos s√£o creditados automaticamente na sua carteira Banca do Marcos.</p>
                </div>
            </div>

            <div class="rule-item">
                <div class="rule-number">4</div>
                <div>
                    <h4 style="margin-bottom: 8px; color: var(--text-primary);">Como fa√ßo um dep√≥sito?</h4>
                    <p style="color: var(--text-secondary); font-size: 14px;">V√° em Configura√ß√µes > Saldo & Dep√≥sitos e escolha o valor e m√©todo de pagamento.</p>
                </div>
            </div>

            <div class="rule-item">
                <div class="rule-number">5</div>
                <div>
                    <h4 style="margin-bottom: 8px; color: var(--text-primary);">Como sacar meus ganhos?</h4>
                    <p style="color: var(--text-secondary); font-size: 14px;">Entre em contato com nosso suporte para solicitar um saque.</p>
                </div>
            </div>

            <div class="rule-item">
                <div class="rule-number">6</div>
                <div>
                    <h4 style="margin-bottom: 8px; color: var(--text-primary);">O jogo √© seguro?</h4>
                    <p style="color: var(--text-secondary); font-size: 14px;">Sim, utilizamos criptografia de ponta para proteger seus dados e transa√ß√µes.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="tutorial-steps">
        <div class="tutorial-step">
            <div class="step-number">1</div>
            <h3 style="margin-bottom: 15px; color: var(--text-primary);">Crie sua Conta</h3>
            <p style="color: var(--text-secondary);">Registre-se em menos de 1 minuto e receba R$ 50 de b√¥nus.</p>
        </div>

        <div class="tutorial-step">
            <div class="step-number">2</div>
            <h3 style="margin-bottom: 15px; color: var(--text-primary);">Fa√ßa um Dep√≥sito</h3>
            <p style="color: var(--text-secondary);">Use PIX, cart√£o ou boleto para adicionar cr√©ditos √† sua conta.</p>
        </div>

        <div class="tutorial-step">
            <div class="step-number">3</div>
            <h3 style="margin-bottom: 15px; color: var(--text-primary);">Escolha seus Animais</h3>
            <p style="color: var(--text-secondary);">Selecione os animais que voc√™ acredita que ser√£o sorteados.</p>
        </div>

        <div class="tutorial-step">
            <div class="step-number">4</div>
            <h3 style="margin-bottom: 15px; color: var(--text-primary);">Aguarde o Sorteio</h3>
            <p style="color: var(--text-secondary);">Os sorteios acontecem a cada 5 minutos. Boa sorte!</p>
        </div>
    </div>
</div>

<!-- Modal de Resultado -->
<div id="resultModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal('resultModal')">
            <i class="fas fa-times"></i>
        </button>

        <div style="text-align: center; margin: 40px 0;">
            <div style="font-size: 96px; color: var(--accent); margin-bottom: 20px;" id="resultAnimalIcon"></div>
            <div style="font-size: 32px; font-weight: 700; color: var(--text-primary); margin-bottom: 15px;" id="resultMessage">Voc√™ Ganhou!</div>
            <div style="font-size: 48px; font-weight: 900; background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 20px 0;" id="resultAmount">R$ 0,00</div>
            <p style="color: var(--text-secondary); margin-bottom: 30px;" id="resultDescription">Parab√©ns! Sua aposta foi vencedora.</p>
        </div>

        <button class="btn btn-primary" onclick="closeModal('resultModal')" style="width: 100%; padding: 18px; font-size: 18px; font-weight: 700;">
            <i class="fas fa-check"></i> Continuar
        </button>
    </div>
</div>

<!-- Modal de Dep√≥sito -->
<div id="depositModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal('depositModal')">
            <i class="fas fa-times"></i>
        </button>

        <h2 style="font-size: 32px; margin-bottom: 20px; color: var(--text-primary);">Dep√≥sito Realizado!</h2>
        <p style="color: var(--text-secondary); margin-bottom: 15px;">Seu dep√≥sito de <strong id="depositAmount">R$ 0,00</strong> foi processado com sucesso.</p>
        <p style="color: var(--text-secondary); margin-bottom: 30px;">Um b√¥nus de <strong id="depositBonus">R$ 0,00</strong> foi adicionado √† sua conta.</p>

        <div style="text-align: center; margin: 30px 0;">
            <div style="font-size: 14px; color: var(--text-secondary);">NOVO SALDO</div>
            <div id="newBalance" style="font-size: 36px; font-weight: 900; color: var(--accent); margin: 10px 0;">R$ 0,00</div>
        </div>

        <button class="btn btn-primary" onclick="closeModal('depositModal')" style="width: 100%; padding: 18px; font-size: 18px; font-weight: 700;">
            <i class="fas fa-check"></i> √ìtimo!
        </button>
    </div>
</div>

<div id="tutorialModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal('tutorialModal')">
            <i class="fas fa-times"></i>
        </button>

        <div id="tutorialStep1" class="tutorial-modal-step active">
            <div style="text-align: center; margin-bottom: 30px;">
                <div style="font-size: 64px; margin-bottom: 20px;">üéØ</div>
                <h2 style="font-size: 32px; margin-bottom: 15px; color: var(--text-primary);">Bem-vindo ao BichoBet!</h2>
                <p style="color: var(--text-secondary);">Vamos te ensinar como funciona em 4 passos simples.</p>
            </div>
            <button class="btn btn-primary" onclick="nextTutorialStep(2)" style="width: 100%; padding: 18px; font-size: 18px; font-weight: 700;">
                <i class="fas fa-arrow-right"></i> Come√ßar Tutorial
            </button>
        </div>

        <div id="tutorialStep2" class="tutorial-modal-step">
            <div style="text-align: center; margin-bottom: 30px;">
                <div style="font-size: 64px; margin-bottom: 20px;">ü¶Å</div>
                <h2 style="font-size: 28px; margin-bottom: 15px; color: var(--text-primary);">Escolha seus Animais</h2>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">Selecione um ou mais animais clicando neles. Cada animal tem 25 n√∫meros associados.</p>
                <div style="background: var(--light-secondary); padding: 20px; border-radius: var(--radius-md); text-align: left;">
                    <p style="margin-bottom: 10px;">‚úÖ Voc√™ pode escolher m√∫ltiplos animais</p>
                    <p style="margin-bottom: 10px;">‚úÖ Cada animal paga 18x o valor apostado</p>
                    <p>‚úÖ Quanto mais animais, maior a chance de ganhar</p>
                </div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <button class="btn btn-secondary" onclick="nextTutorialStep(1)" style="padding: 18px;">
                    <i class="fas fa-arrow-left"></i> Voltar
                </button>
                <button class="btn btn-primary" onclick="nextTutorialStep(3)" style="padding: 18px;">
                    Pr√≥ximo <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>

        <div id="tutorialStep3" class="tutorial-modal-step">
            <div style="text-align: center; margin-bottom: 30px;">
                <div style="font-size: 64px; margin-bottom: 20px;">üí∞</div>
                <h2 style="font-size: 28px; margin-bottom: 15px; color: var(--text-primary);">Defina o Valor</h2>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">Escolha quanto quer apostar em cada animal selecionado.</p>
                <div style="background: var(--light-secondary); padding: 20px; border-radius: var(--radius-md); text-align: left;">
                    <p style="margin-bottom: 10px;">üíµ Valor m√≠nimo: R$ 1,00</p>
                    <p style="margin-bottom: 10px;">üíµ Valor m√°ximo: R$ 1.000,00</p>
                    <p>üíµ Use os bot√µes r√°pidos para facilitar</p>
                </div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <button class="btn btn-secondary" onclick="nextTutorialStep(2)" style="padding: 18px;">
                    <i class="fas fa-arrow-left"></i> Voltar
                </button>
                <button class="btn btn-primary" onclick="nextTutorialStep(4)" style="padding: 18px;">
                    Pr√≥ximo <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>

        <div id="tutorialStep4" class="tutorial-modal-step">
            <div style="text-align: center; margin-bottom: 30px;">
                <div style="font-size: 64px; margin-bottom: 20px;">‚è∞</div>
                <h2 style="font-size: 28px; margin-bottom: 15px; color: var(--text-primary);">Aguarde o Sorteio</h2>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">Os sorteios acontecem a cada 5 minutos automaticamente!</p>
                <div style="background: var(--light-secondary); padding: 20px; border-radius: var(--radius-md); text-align: left;">
                    <p style="margin-bottom: 10px;">‚è∞ Sorteios 24/7</p>
                    <p style="margin-bottom: 10px;">üéâ Ganhos pagos instantaneamente</p>
                    <p>üìä Acompanhe os resultados em tempo real</p>
                </div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <button class="btn btn-secondary" onclick="nextTutorialStep(3)" style="padding: 18px;">
                    <i class="fas fa-arrow-left"></i> Voltar
                </button>
                <button class="btn btn-primary" onclick="closeTutorial()" style="padding: 18px;">
                    <i class="fas fa-check"></i> Come√ßar a Jogar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Confirma√ß√£o de Aposta -->
<div id="confirmBetModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal('confirmBetModal')">
            <i class="fas fa-times"></i>
        </button>

        <h2 style="font-size: 32px; margin-bottom: 25px; color: var(--text-primary); text-align: center;">Confirmar Aposta</h2>

        <div style="background: var(--light-secondary); padding: 25px; border-radius: var(--radius-md); margin-bottom: 25px;">
            <div style="margin-bottom: 20px;">
                <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 10px;">ANIMAIS SELECIONADOS</div>
                <div id="confirmBetAnimals" style="display: flex; gap: 10px; flex-wrap: wrap;"></div>
            </div>

            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 20px;">
                <div>
                    <div style="font-size: 12px; color: var(--text-secondary);">VALOR POR ANIMAL</div>
                    <div id="confirmBetAmountPerAnimal" style="font-size: 24px; font-weight: 800; color: var(--text-primary);">R$ 0,00</div>
                </div>
                <div>
                    <div style="font-size: 12px; color: var(--text-secondary);">TOTAL DA APOSTA</div>
                    <div id="confirmBetTotal" style="font-size: 24px; font-weight: 800; color: var(--accent);">R$ 0,00</div>
                </div>
            </div>

            <div style="border-top: 2px solid var(--border); padding-top: 15px;">
                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px;">GANHO POTENCIAL</div>
                <div id="confirmBetPotentialWin" style="font-size: 32px; font-weight: 900; background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">R$ 0,00</div>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 15px;">
            <button class="btn btn-secondary" onclick="closeModal('confirmBetModal')" style="padding: 18px; font-size: 16px;">
                <i class="fas fa-times"></i> Cancelar
            </button>
            <button class="btn btn-primary" onclick="confirmAndPlaceBet()" style="padding: 18px; font-size: 16px;">
                <i class="fas fa-check"></i> Confirmar Aposta
            </button>
        </div>
    </div>
</div>

<!-- Modal de Detalhes do Animal -->
<div id="animalDetailsModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal('animalDetailsModal')">
            <i class="fas fa-times"></i>
        </button>

        <div style="text-align: center; margin-bottom: 30px;">
            <div id="animalDetailIcon" style="font-size: 96px; margin-bottom: 20px;">ü¶Å</div>
            <h2 id="animalDetailName" style="font-size: 36px; margin-bottom: 10px; color: var(--text-primary);">Le√£o</h2>
            <div style="display: inline-block; background: var(--accent-gradient); color: white; padding: 8px 20px; border-radius: 50px; font-weight: 700; margin-bottom: 20px;">
                Grupo <span id="animalDetailGroup">4¬∫</span> - N√∫mero <span id="animalDetailNumber">16</span>
            </div>
        </div>

        <div style="background: var(--light-secondary); padding: 25px; border-radius: var(--radius-md); margin-bottom: 25px;">
            <h3 style="margin-bottom: 15px; color: var(--text-primary);">üìä Estat√≠sticas</h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                <div>
                    <div style="font-size: 12px; color: var(--text-secondary);">MULTIPLICADOR</div>
                    <div style="font-size: 24px; font-weight: 800; color: var(--accent);">18x</div>
                </div>
                <div>
                    <div style="font-size: 12px; color: var(--text-secondary);">√öLTIMA APARI√á√ÉO</div>
                    <div id="animalLastSeen" style="font-size: 14px; font-weight: 600; color: var(--text-primary);">15 min atr√°s</div>
                </div>
                <div>
                    <div style="font-size: 12px; color: var(--text-secondary);">FREQU√äNCIA (24H)</div>
                    <div id="animalFrequency" style="font-size: 14px; font-weight: 600; color: var(--text-primary);">3.8%</div>
                </div>
                <div>
                    <div style="font-size: 12px; color: var(--text-secondary);">POPULARIDADE</div>
                    <div id="animalPopularity" style="font-size: 14px; font-weight: 600; color: var(--text-primary);">Alta üî•</div>
                </div>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <button class="btn btn-secondary" onclick="addToFavorites()" style="padding: 18px;">
                <i class="fas fa-star"></i> Favoritar
            </button>
            <button class="btn btn-primary" onclick="selectAnimalAndClose()" style="padding: 18px;">
                <i class="fas fa-check"></i> Selecionar
            </button>
        </div>
    </div>
</div>

<!-- Modal de Jogo Respons√°vel -->
<div id="responsibleGamingModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal('responsibleGamingModal')">
            <i class="fas fa-times"></i>
        </button>

        <h2 style="font-size: 32px; margin-bottom: 20px; color: var(--text-primary); text-align: center;">‚ö†Ô∏è Jogo Respons√°vel</h2>

        <div style="background: rgba(245, 158, 11, 0.1); padding: 25px; border-radius: var(--radius-md); border: 2px solid var(--warning); margin-bottom: 25px;">
            <p style="color: var(--text-primary); margin-bottom: 15px; font-weight: 600;">Estabele√ßa seus limites de jogo:</p>
            <p style="color: var(--text-secondary); margin-bottom: 10px;">‚Ä¢ Jogue apenas com dinheiro que voc√™ pode perder</p>
            <p style="color: var(--text-secondary); margin-bottom: 10px;">‚Ä¢ Defina um or√ßamento di√°rio/semanal</p>
            <p style="color: var(--text-secondary); margin-bottom: 10px;">‚Ä¢ Fa√ßa pausas regulares</p>
            <p style="color: var(--text-secondary);">‚Ä¢ Nunca tente recuperar perdas</p>
        </div>

        <div style="margin-bottom: 25px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary);">Limite Di√°rio de Apostas (R$)</label>
            <input type="number" id="dailyLimit" style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px;" placeholder="Ex: 100" min="1">
        </div>

        <div style="margin-bottom: 25px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary);">Limite de Tempo Di√°rio (minutos)</label>
            <input type="number" id="timeLimit" style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px;" placeholder="Ex: 60" min="1">
        </div>

        <div style="margin-bottom: 25px;">
            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                <input type="checkbox" id="selfExclude" style="width: 20px; height: 20px;">
                <span style="font-weight: 600; color: var(--text-primary);">Solicitar autoexclus√£o tempor√°ria (24h)</span>
            </label>
        </div>

        <button class="btn btn-primary" onclick="saveResponsibleLimits()" style="width: 100%; padding: 18px; font-size: 18px;">
            <i class="fas fa-save"></i> Salvar Limites
        </button>
    </div>
</div>

<!-- Modal de Promo√ß√µes -->
<div id="promotionsModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal('promotionsModal')">
            <i class="fas fa-times"></i>
        </button>

        <h2 style="font-size: 32px; margin-bottom: 25px; color: var(--text-primary); text-align: center;">üéÅ Promo√ß√µes Ativas</h2>

        <div id="promotionsList" style="display: grid; gap: 20px;">
            <!-- Promo√ß√µes ser√£o inseridas aqui -->
        </div>
    </div>
</div>

<!-- Modal de Estat√≠sticas Avan√ßadas -->
<div id="statsModal" class="modal">
    <div class="modal-content" style="max-width: 800px;">
        <button class="modal-close" onclick="closeModal('statsModal')">
            <i class="fas fa-times"></i>
        </button>

        <h2 style="font-size: 32px; margin-bottom: 25px; color: var(--text-primary); text-align: center;">üìä Estat√≠sticas Detalhadas</h2>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
            <div style="background: var(--light-secondary); padding: 20px; border-radius: var(--radius-md); text-align: center;">
                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 10px;">TOTAL APOSTADO</div>
                <div id="statsModalTotalBet" style="font-size: 28px; font-weight: 800; color: var(--text-primary);">R$ 0</div>
            </div>
            <div style="background: var(--light-secondary); padding: 20px; border-radius: var(--radius-md); text-align: center;">
                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 10px;">TOTAL GANHO</div>
                <div id="statsModalTotalWon" style="font-size: 28px; font-weight: 800; color: var(--accent);">R$ 0</div>
            </div>
            <div style="background: var(--light-secondary); padding: 20px; border-radius: var(--radius-md); text-align: center;">
                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 10px;">TAXA DE VIT√ìRIA</div>
                <div id="statsModalWinRate" style="font-size: 28px; font-weight: 800; color: var(--info);">0%</div>
            </div>
            <div style="background: var(--light-secondary); padding: 20px; border-radius: var(--radius-md); text-align: center;">
                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 10px;">MAIOR VIT√ìRIA</div>
                <div id="statsModalBiggestWin" style="font-size: 28px; font-weight: 800; color: var(--purple);">R$ 0</div>
            </div>
        </div>

        <h3 style="margin-bottom: 15px; color: var(--text-primary);">ü¶Å Animais Mais Apostados</h3>
        <div id="statsModalFavoriteAnimals" style="margin-bottom: 30px;">
            <!-- Lista ser√° preenchida dinamicamente -->
        </div>

        <h3 style="margin-bottom: 15px; color: var(--text-primary);">üìà Hist√≥rico Recente</h3>
        <div id="statsModalRecentBets" style="max-height: 300px; overflow-y: auto;">
            <!-- Lista ser√° preenchida dinamicamente -->
        </div>
    </div>
</div>

<!-- Modal de Suporte -->
<div id="supportModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal('supportModal')">
            <i class="fas fa-times"></i>
        </button>

        <h2 style="font-size: 32px; margin-bottom: 25px; color: var(--text-primary); text-align: center;">üí¨ Suporte ao Cliente</h2>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
            <div style="background: var(--light-secondary); padding: 25px; border-radius: var(--radius-md); text-align: center; cursor: pointer; transition: var(--transition);" onmouseover="this.style.transform='translateY(-5px)'" onmouseout="this.style.transform='translateY(0)'">
                <div style="font-size: 48px; margin-bottom: 15px;">üí¨</div>
                <div style="font-weight: 700; margin-bottom: 5px;">Chat ao Vivo</div>
                <div style="font-size: 12px; color: var(--text-secondary);">Resposta imediata</div>
            </div>
            <div style="background: var(--light-secondary); padding: 25px; border-radius: var(--radius-md); text-align: center; cursor: pointer; transition: var(--transition);" onmouseover="this.style.transform='translateY(-5px)'" onmouseout="this.style.transform='translateY(0)'">
                <div style="font-size: 48px; margin-bottom: 15px;">üìß</div>
                <div style="font-weight: 700; margin-bottom: 5px;">Email</div>
                <div style="font-size: 12px; color: var(--text-secondary);">suporte@bichobet.com</div>
            </div>
            <div style="background: var(--light-secondary); padding: 25px; border-radius: var(--radius-md); text-align: center; cursor: pointer; transition: var(--transition);" onmouseover="this.style.transform='translateY(-5px)'" onmouseout="this.style.transform='translateY(0)'">
                <div style="font-size: 48px; margin-bottom: 15px;">üì±</div>
                <div style="font-weight: 700; margin-bottom: 5px;">WhatsApp</div>
                <div style="font-size: 12px; color: var(--text-secondary);">(11) 99999-9999</div>
            </div>
        </div>

        <form onsubmit="sendSupportMessage(event)" style="margin-bottom: 25px;">
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary);">Assunto</label>
                <select id="supportSubject" style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px;">
                    <option>Problemas com dep√≥sito</option>
                    <option>Problemas com saque</option>
                    <option>D√∫vidas sobre apostas</option>
                    <option>Problemas t√©cnicos</option>
                    <option>Outros</option>
                </select>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary);">Mensagem</label>
                <textarea id="supportMessage" rows="5" style="width: 100%; padding: 16px 20px; border: 2px solid var(--border); border-radius: var(--radius-sm); background: var(--light); color: var(--text-primary); font-size: 16px; resize: vertical;" placeholder="Descreva seu problema ou d√∫vida..."></textarea>
            </div>

            <button type="submit" class="btn btn-primary" style="width: 100%; padding: 18px; font-size: 18px;">
                <i class="fas fa-paper-plane"></i> Enviar Mensagem
            </button>
        </form>

        <div style="background: rgba(59, 130, 246, 0.1); padding: 20px; border-radius: var(--radius-md); border: 2px solid var(--info);">
            <p style="color: var(--text-primary); font-weight: 600; margin-bottom: 10px;">‚è∞ Hor√°rio de Atendimento</p>
            <p style="color: var(--text-secondary); font-size: 14px;">Segunda a Domingo: 24 horas por dia</p>
        </div>
    </div>
</div>

<!-- Modal de Conquistas -->
<div id="achievementsModal" class="modal">
    <div class="modal-content" style="max-width: 700px;">
        <button class="modal-close" onclick="closeModal('achievementsModal')">
            <i class="fas fa-times"></i>
        </button>

        <h2 style="font-size: 32px; margin-bottom: 25px; color: var(--text-primary); text-align: center;">üèÜ Conquistas</h2>

        <div id="achievementsList" style="display: grid; gap: 15px;">
            <!-- Conquistas ser√£o inseridas aqui -->
        </div>
    </div>
</div>

<!-- Notifications Container -->
<div id="notificationContainer"></div>

<!-- Confetti Container -->
<div id="confettiContainer"></div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>


<script>
    // ==================== CONFIGURA√á√ÉO DO FIREBASE ====================
    const firebaseConfig = {

        apiKey: "AIzaSyCRrz6AIy0nmU2LCXIM3r2_9_O6AJea-yM",

        authDomain: "marcosbet-def.firebaseapp.com",

        databaseURL: "https://marcosbet-def-default-rtdb.firebaseio.com",

        projectId: "marcosbet-def",

        storageBucket: "marcosbet-def.firebasestorage.app",

        messagingSenderId: "637877497672",

        appId: "1:637877497672:web:acc3c8e8c853fd53d24d7d"

    };


    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // ==================== VARI√ÅVEIS GLOBAIS ====================
    let currentUser = null;
    let currentUserData = null;
    let unsubscribeDraws = null;
    let unsubscribeJackpot = null;
    let unsubscribeOnlinePlayers = null;

    const animals = [
        { number: 1, name: "Avestruz", icon: "üê¶", odds: 18, group: "1¬∫", color: "#10B981" },
        { number: 2, name: "√Åguia", icon: "ü¶Ö", odds: 18, group: "1¬∫", color: "#3B82F6" },
        { number: 3, name: "Burro", icon: "üê¥", odds: 18, group: "1¬∫", color: "#8B5CF6" },
        { number: 4, name: "Borboleta", icon: "ü¶ã", odds: 18, group: "1¬∫", color: "#EC4899" },
        { number: 5, name: "Cachorro", icon: "üêï", odds: 18, group: "1¬∫", color: "#F59E0B" },
        { number: 6, name: "Cabra", icon: "üêê", odds: 18, group: "2¬∫", color: "#10B981" },
        { number: 7, name: "Carneiro", icon: "üêë", odds: 18, group: "2¬∫", color: "#3B82F6" },
        { number: 8, name: "Camelo", icon: "üê´", odds: 18, group: "2¬∫", color: "#8B5CF6" },
        { number: 9, name: "Cobra", icon: "üêç", odds: 18, group: "2¬∫", color: "#EC4899" },
        { number: 10, name: "Coelho", icon: "üêá", odds: 18, group: "2¬∫", color: "#F59E0B" },
        { number: 11, name: "Cavalo", icon: "üêé", odds: 18, group: "3¬∫", color: "#10B981" },
        { number: 12, name: "Elefante", icon: "üêò", odds: 18, group: "3¬∫", color: "#3B82F6" },
        { number: 13, name: "Galo", icon: "üêì", odds: 18, group: "3¬∫", color: "#8B5CF6" },
        { number: 14, name: "Gato", icon: "üêà", odds: 18, group: "3¬∫", color: "#EC4899" },
        { number: 15, name: "Jacar√©", icon: "üêä", odds: 18, group: "3¬∫", color: "#F59E0B" },
        { number: 16, name: "Le√£o", icon: "ü¶Å", odds: 18, group: "4¬∫", color: "#10B981" },
        { number: 17, name: "Macaco", icon: "üêí", odds: 18, group: "4¬∫", color: "#3B82F6" },
        { number: 18, name: "Porco", icon: "üêñ", odds: 18, group: "4¬∫", color: "#8B5CF6" },
        { number: 19, name: "Pav√£o", icon: "ü¶ö", odds: 18, group: "4¬∫", color: "#EC4899" },
        { number: 20, name: "Peru", icon: "ü¶É", odds: 18, group: "4¬∫", color: "#F59E0B" },
        { number: 21, name: "Touro", icon: "üêÇ", odds: 18, group: "5¬∫", color: "#10B981" },
        { number: 22, name: "Tigre", icon: "üêÖ", odds: 18, group: "5¬∫", color: "#3B82F6" },
        { number: 23, name: "Urso", icon: "üêª", odds: 18, group: "5¬∫", color: "#8B5CF6" },
        { number: 24, name: "Veado", icon: "ü¶å", odds: 18, group: "5¬∫", color: "#EC4899" },
        { number: 25, name: "Vaca", icon: "üêÑ", odds: 18, group: "5¬∫", color: "#F59E0B" }
    ];

    let selectedAnimals = [];
    let currentBetAmount = 10;
    let userBets = [];
    let betType = 'simple';
    let selectedDepositAmount = 0;
    let selectedPaymentMethod = '';
    let currentTutorialStep = 1;
    let currentAnimalDetail = null;
    let favoriteAnimals = [];
    let userAchievements = [];
    let responsibleLimits = {
        dailyLimit: 0,
        timeLimit: 0,
        selfExclude: false
    };

    // ==================== SISTEMA DE SORTEIOS EM TEMPO REAL ====================

    function getNextDrawTime() {
        const now = new Date();
        const minutes = now.getMinutes();
        const nextMinutes = Math.ceil(minutes / 5) * 5;

        const nextDraw = new Date();
        nextDraw.setMinutes(nextMinutes);
        nextDraw.setSeconds(0);
        nextDraw.setMilliseconds(0);

        if (nextMinutes === 60) {
            nextDraw.setHours(now.getHours() + 1);
            nextDraw.setMinutes(0);
        }

        return nextDraw;
    }


    // ==================== SISTEMA DE PRESEN√áA E JOGADORES ONLINE ====================

    async function updateUserPresence(online) {
        if (!currentUser) return;

        try {
            const presenceRef = db.collection('presence').doc(currentUser.uid);

            if (online) {
                await presenceRef.set({
                    online: true,
                    lastSeen: firebase.firestore.FieldValue.serverTimestamp(),
                    userId: currentUser.uid
                });

                // Incrementar contador global
                await db.collection('system').doc('global').update({
                    onlinePlayers: firebase.firestore.FieldValue.increment(1)
                });

                // Configurar listener para desconex√£o
                window.addEventListener('beforeunload', () => {
                    updateUserPresence(false);
                });

                // Atualizar presen√ßa a cada 30 segundos
                setInterval(async () => {
                    if (currentUser) {
                        await presenceRef.update({
                            lastSeen: firebase.firestore.FieldValue.serverTimestamp()
                        });
                    }
                }, 30000);

            } else {
                await presenceRef.update({
                    online: false,
                    lastSeen: firebase.firestore.FieldValue.serverTimestamp()
                });

                // Decrementar contador global
                await db.collection('system').doc('global').update({
                    onlinePlayers: firebase.firestore.FieldValue.increment(-1)
                });
            }
        } catch (error) {
            console.error('Erro ao atualizar presen√ßa:', error);
        }
    }

    // ==================== SISTEMA DE AUTENTICA√á√ÉO COM FIREBASE ====================

    auth.onAuthStateChanged(async (user) => {
        if (user) {
            currentUser = user;
            await loadUserData(user.uid);
            await initializeGlobalDrawSystem();
            showMainApp();
            updateGameStats();
        } else {
            currentUser = null;
            currentUserData = null;

            // Limpar listeners
            if (unsubscribeDraws) unsubscribeDraws();
            if (unsubscribeJackpot) unsubscribeJackpot();
            if (unsubscribeOnlinePlayers) unsubscribeOnlinePlayers();
        }
    });

    async function loadUserData(uid) {
        try {
            console.log('üì• Buscando dados do usu√°rio:', uid);

            const userDoc = await db.collection('users').doc(uid).get();

            if (userDoc.exists) {
                currentUserData = { ...userDoc.data(), uid };
                console.log('‚úÖ Dados do usu√°rio carregados:', currentUserData);

                // Carregar apostas do usu√°rio
                console.log('üì• Carregando apostas...');
                await loadUserBets();

                // Atualizar a interface do usu√°rio
                console.log('üé® Atualizando interface...');
                updateUserDisplay();

                console.log('‚úÖ Dados do usu√°rio prontos!');
            } else {
                console.log('‚ö†Ô∏è Usu√°rio n√£o existe no banco. Criando...');
                await createNewUserData(uid);
            }
        } catch (error) {
            console.error('‚ùå Erro ao carregar dados do usu√°rio:', error);
            console.error('Detalhes:', error.message, error.stack);
            showNotification('‚ùå Erro ao carregar dados: ' + error.message, 'error');
            throw error; // Re-throw para o handler acima
        }
    }

    async function createNewUserData(uid) {
        const newUserData = {
            uid,
            email: currentUser.email,
            balance: 50,
            fullName: '',
            phone: '',
            memberSince: new Date().getFullYear().toString(),
            totalBets: 0,
            totalWins: 0,
            level: 1,
            xp: 0,
            nextLevelXp: 100,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        };

        try {
            await db.collection('users').doc(uid).set(newUserData);
            currentUserData = newUserData;

            await db.collection('users').doc(uid).collection('settings').doc('preferences').set({
                notifications: true,
                promotions: true,
                soundEffects: false,
                language: 'pt'
            });

            showNotification('üéâ B√¥nus de boas-vindas: R$ 50,00 creditados!', 'success');
        } catch (error) {
            console.error('Erro ao criar usu√°rio:', error);
        }
    }

    async function loadUserBets() {
        if (!currentUser) return;

        try {
            const betsSnapshot = await db.collection('users')
                .doc(currentUser.uid)
                .collection('bets')
                .where('status', '==', 'pending')
                .get();

            userBets = betsSnapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data()
            }));

            updateBetsList();
        } catch (error) {
            console.error('Erro ao carregar apostas:', error);
            userBets = [];
        }
    }

    async function loadUserSettings() {
        if (!currentUser) return;

        try {
            const settingsDoc = await db.collection('users')
                .doc(currentUser.uid)
                .collection('settings')
                .doc('preferences')
                .get();

            if (settingsDoc.exists) {
                currentUserData.settings = settingsDoc.data();

                // Aplicar prefer√™ncias
                if (currentUserData.settings.notifications !== undefined) {
                    document.getElementById('notifications').checked = currentUserData.settings.notifications;
                }
                if (currentUserData.settings.promotions !== undefined) {
                    document.getElementById('promotions').checked = currentUserData.settings.promotions;
                }
                if (currentUserData.settings.soundEffects !== undefined) {
                    document.getElementById('soundEffects').checked = currentUserData.settings.soundEffects;
                }
                if (currentUserData.settings.language) {
                    document.getElementById('language').value = currentUserData.settings.language;
                }
            }
        } catch (error) {
            console.error('Erro ao carregar configura√ß√µes:', error);
        }
    }

    async function loadUserAchievements() {
        if (!currentUser) return;

        try {
            const achievementsDoc = await db.collection('users')
                .doc(currentUser.uid)
                .collection('settings')
                .doc('achievements')
                .get();

            if (achievementsDoc.exists) {
                userAchievements = achievementsDoc.data().list || [];
            }
        } catch (error) {
            console.error('Erro ao carregar conquistas:', error);
        }
    }

    async function loadFavoriteAnimals() {
        if (!currentUser) return;

        try {
            const favoritesDoc = await db.collection('users')
                .doc(currentUser.uid)
                .collection('settings')
                .doc('favorites')
                .get();

            if (favoritesDoc.exists) {
                favoriteAnimals = favoritesDoc.data().animals || [];
            }
        } catch (error) {
            console.error('Erro ao carregar favoritos:', error);
        }
    }

    async function loadResponsibleLimits() {
        if (!currentUser) return;

        try {
            const limitsDoc = await db.collection('users')
                .doc(currentUser.uid)
                .collection('settings')
                .doc('limits')
                .get();

            if (limitsDoc.exists) {
                responsibleLimits = limitsDoc.data();

                // Verificar autoexclus√£o
                if (responsibleLimits.selfExcludeUntil) {
                    const excludeUntil = responsibleLimits.selfExcludeUntil.toDate();
                    if (new Date() < excludeUntil) {
                        showNotification('‚ö†Ô∏è Sua conta est√° em autoexclus√£o at√© ' + excludeUntil.toLocaleString(), 'warning');
                        setTimeout(() => logout(), 3000);
                    }
                }
            }
        } catch (error) {
            console.error('Erro ao carregar limites:', error);
        }
    }

    async function updateUserData() {
        if (!currentUser || !currentUserData) return;

        try {
            await db.collection('users').doc(currentUser.uid).update({
                balance: currentUserData.balance,
                fullName: currentUserData.fullName || '',
                phone: currentUserData.phone || '',
                totalBets: currentUserData.totalBets,
                totalWins: currentUserData.totalWins,
                level: currentUserData.level,
                xp: currentUserData.xp,
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            });
        } catch (error) {
            console.error('Erro ao atualizar usu√°rio:', error);
            showNotification('‚ùå Erro ao salvar dados!', 'error');
        }
    }

    // ==================== SISTEMA DE APOSTAS COM FIREBASE ====================

    async function placeBet() {
        if (!currentUser || !currentUserData) return;

        if (selectedAnimals.length === 0) {
            showNotification('‚ö†Ô∏è Selecione pelo menos um animal para apostar!', 'warning');
            return;
        }

        const betAmount = parseInt(document.getElementById('betAmount').value) || 10;
        let totalBet = betAmount * selectedAnimals.length;

        if (betType === 'multiple' && selectedAnimals.length > 1) {
            totalBet = Math.floor(totalBet * 0.9);
        }

        if (currentUserData.balance < totalBet) {
            showNotification('‚ùå Saldo insuficiente para realizar esta aposta!', 'error');
            return;
        }

        // Verificar limites de jogo respons√°vel
        if (responsibleLimits.dailyLimit > 0) {
            const todayBets = await getTodayBets();
            if (todayBets + totalBet > responsibleLimits.dailyLimit) {
                showNotification('‚ö†Ô∏è Voc√™ atingiu seu limite di√°rio de apostas!', 'warning');
                showModal('responsibleGamingModal');
                return;
            }
        }

        showConfirmBetModal(betAmount, totalBet);
    }


    function checkLevelUp() {
        if (currentUserData.xp >= currentUserData.nextLevelXp) {
            currentUserData.level++;
            currentUserData.xp -= currentUserData.nextLevelXp;
            currentUserData.nextLevelXp = Math.floor(currentUserData.nextLevelXp * 1.5);

            showNotification(`üéâ Level Up! Voc√™ alcan√ßou o n√≠vel ${currentUserData.level}!`, 'success');
            createConfetti();

            updateUserData();
        }
    }

    // ==================== SISTEMA DE TIMER E ATUALIZA√á√ïES ====================

    function initTimer() {
        console.log('üïê Inicializando timer...');

        // Listener para o documento global
        const unsubscribe = db.collection('system').doc('global')
            .onSnapshot((doc) => {
                if (!doc.exists) {
                    console.warn('‚ö†Ô∏è Documento global n√£o existe');
                    document.getElementById('drawTimer').textContent = '--:--';
                    return;
                }

                const data = doc.data();

                // Atualizar jackpot
                if (data.jackpot !== undefined) {
                    const jackpotEl = document.getElementById('jackpotAmount');
                    if (jackpotEl) {
                        jackpotEl.textContent = `R$ ${data.jackpot.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`;
                    }
                }

                // Atualizar jogadores online
                if (data.onlinePlayers !== undefined) {
                    const onlineElements = document.querySelectorAll('.header-card:nth-child(3) .stat-value, .header-card:nth-child(3) div[style*="font-size: 32px"]');
                    onlineElements.forEach(el => {
                        el.textContent = data.onlinePlayers.toLocaleString();
                    });
                }

                // Atualizar n√∫mero do sorteio
                if (data.drawNumber) {
                    const drawNumElements = document.querySelectorAll('.header-card:nth-child(2) > div:last-child');
                    drawNumElements.forEach(el => {
                        el.textContent = `Sorteio #${data.drawNumber}`;
                    });
                }

                console.log('üìä Dados atualizados:', {
                    jackpot: data.jackpot,
                    drawNumber: data.drawNumber,
                    onlinePlayers: data.onlinePlayers,
                    nextDrawTime: data.nextDrawTime?.toDate().toLocaleString('pt-BR')
                });

            }, (error) => {
                console.error('‚ùå Erro ao escutar global:', error);
            });

        // Armazenar unsubscribe
        if (window.unsubscribeGlobal) window.unsubscribeGlobal();
        window.unsubscribeGlobal = unsubscribe;

        // Atualizar timer a cada segundo
        setInterval(async () => {
            try {
                const globalDoc = await db.collection('system').doc('global').get();

                if (!globalDoc.exists) {
                    document.getElementById('drawTimer').textContent = '--:--';
                    return;
                }

                const data = globalDoc.data();

                if (!data.nextDrawTime) {
                    document.getElementById('drawTimer').textContent = '--:--';
                    return;
                }

                const nextDrawTime = data.nextDrawTime.toDate();
                const now = new Date();
                const diff = nextDrawTime - now;

                if (diff <= 0) {
                    document.getElementById('drawTimer').textContent = '00:00';
                    return;
                }

                const minutesLeft = Math.floor(diff / (1000 * 60));
                const secondsLeft = Math.floor((diff % (1000 * 60)) / 1000);

                const timerEl = document.getElementById('drawTimer');
                if (timerEl) {
                    timerEl.textContent =
                        `${minutesLeft.toString().padStart(2, '0')}:${secondsLeft.toString().padStart(2, '0')}`;
                }

            } catch (error) {
                console.error('‚ùå Erro ao atualizar timer:', error);
                document.getElementById('drawTimer').textContent = '--:--';
            }
        }, 1000);

        console.log('‚úÖ Timer inicializado');
    }
    async function getTodayBets() {
        if (!currentUser) return 0;

        try {
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            const betsSnapshot = await db.collection('users')
                .doc(currentUser.uid)
                .collection('bets')
                .where('date', '>=', firebase.firestore.Timestamp.fromDate(today))
                .get();

            return betsSnapshot.docs.reduce((sum, doc) => sum + doc.data().amount, 0);
        } catch (error) {
            console.error('Erro ao calcular apostas do dia:', error);
            return 0;
        }
    }

    async function checkAchievements() {
        if (!currentUserData) return;

        const achievements = [
            { id: 'first_bet', title: 'Primeira Aposta', requirement: 1, field: 'totalBets', bonus: 10 },
            { id: 'bet_10', title: 'Apostador Iniciante', requirement: 10, field: 'totalBets', bonus: 25 },
            { id: 'bet_50', title: 'Apostador Experiente', requirement: 50, field: 'totalBets', bonus: 100 },
            { id: 'bet_100', title: 'Apostador Veterano', requirement: 100, field: 'totalBets', bonus: 250 },
            { id: 'win_first', title: 'Primeira Vit√≥ria', requirement: 1, field: 'totalWins', bonus: 20 },
            { id: 'win_10', title: 'Sortudo', requirement: 10, field: 'totalWins', bonus: 50 }
        ];

        const newAchievements = [];

        for (const achievement of achievements) {
            if (currentUserData[achievement.field] >= achievement.requirement && !userAchievements.includes(achievement.id)) {
                newAchievements.push(achievement);
            }
        }

        if (newAchievements.length > 0) {
            for (const achievement of newAchievements) {
                userAchievements.push(achievement.id);

                // Adicionar b√¥nus
                currentUserData.balance += achievement.bonus;

                showNotification(`üèÜ Conquista desbloqueada: ${achievement.title}! B√¥nus: R$ ${achievement.bonus}`, 'success');
                createConfetti();
            }

            try {
                // Salvar conquistas
                await db.collection('users')
                    .doc(currentUser.uid)
                    .collection('settings')
                    .doc('achievements')
                    .set({ list: userAchievements });

                // Atualizar saldo com b√¥nus
                await updateUserData();
                updateUserDisplay();
            } catch (error) {
                console.error('Erro ao salvar conquistas:', error);
            }
        }
    }


    function initAuthTabs() {
        const tabs = document.querySelectorAll('.auth-tab');
        const forms = document.querySelectorAll('.auth-form');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabName = tab.getAttribute('data-tab');

                // Atualizar abas
                tabs.forEach(t => {
                    t.classList.remove('active');
                    t.style.background = 'none';
                    t.style.color = 'var(--text-secondary)';
                });

                forms.forEach(f => {
                    f.style.display = 'none';
                    f.classList.remove('active');
                });

                tab.classList.add('active');
                tab.style.background = 'var(--accent-gradient)';
                tab.style.color = 'white';

                const form = document.getElementById(`${tabName}Form`);
                if (form) {
                    form.style.display = 'block';
                    form.classList.add('active');
                }
            });
        });

        // Login
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            try {
                // Se o usu√°rio digitou "kayua" e senha "12345", use o email de teste
                if (username === 'kayua' && password === '12345') {
                    await auth.signInWithEmailAndPassword('kayua@teste.com', '12345');
                } else {
                    // Caso contr√°rio, tente fazer login com o que foi digitado (assumindo que √© email)
                    await auth.signInWithEmailAndPassword(username, password);
                }
                showNotification('üéâ Login realizado com sucesso!', 'success');
                createConfetti();
            } catch (error) {
                console.error('Erro no login:', error);
                showNotification('‚ùå Usu√°rio ou senha incorretos!', 'error');
            }
        });

        // Cadastro
        document.getElementById('registerForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const username = document.getElementById('registerUsername').value.trim();
            const email = document.getElementById('registerEmail').value.trim();
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;

            if (!username || !email || !password || !confirmPassword) {
                showNotification('‚ùå Por favor, preencha todos os campos!', 'error');
                return;
            }

            if (password.length < 5) {
                showNotification('‚ùå A senha deve ter pelo menos 5 caracteres!', 'error');
                return;
            }

            if (password !== confirmPassword) {
                showNotification('‚ùå As senhas n√£o coincidem!', 'error');
                return;
            }

            try {
                // Criar usu√°rio no Firebase Auth
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;

                // Criar documento do usu√°rio no Firestore
                await db.collection('users').doc(user.uid).set({
                    uid: user.uid,
                    email: email,
                    username: username,
                    balance: 50, // B√¥nus de boas-vindas
                    fullName: '',
                    phone: '',
                    memberSince: new Date().getFullYear().toString(),
                    totalBets: 0,
                    totalWins: 0,
                    level: 1,
                    xp: 0,
                    nextLevelXp: 100,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                // Criar configura√ß√µes padr√£o
                await db.collection('users').doc(user.uid).collection('settings').doc('preferences').set({
                    notifications: true,
                    promotions: true,
                    soundEffects: false,
                    language: 'pt'
                });

                showNotification('üéâ Conta criada com sucesso! R$ 50 de b√¥nus adicionados.', 'success');
                createConfetti();

                setTimeout(() => {
                    showTutorial();
                }, 1500);
            } catch (error) {
                console.error('Erro no cadastro:', error);
                if (error.code === 'auth/email-already-in-use') {
                    showNotification('‚ùå Este email j√° est√° cadastrado!', 'error');
                } else if (error.code === 'auth/invalid-email') {
                    showNotification('‚ùå Email inv√°lido!', 'error');
                } else {
                    showNotification('‚ùå Erro ao criar conta!', 'error');
                }
            }
        });
    }

    // ==================== CONTINUA√á√ÉO DAS FUN√á√ïES (ser√° o mesmo c√≥digo anterior para UI, modais, etc) ====================

    // [Copiar o restante das fun√ß√µes do c√≥digo original: initAnimalsGrid, toggleAnimalSelection,
    // showSection, updateUserDisplay, showModal, closeModal, showNotification, createConfetti,
    // initTheme, initParticles, loadRecentDraws, loadTopWinners, etc.]

    function initAnimalsGrid() {
        const grid = document.getElementById('animalsGrid');
        grid.innerHTML = '';

        animals.forEach(animal => {
            const card = document.createElement('div');
            card.className = 'animal-card';
            card.dataset.number = animal.number;
            card.innerHTML = `
                <div style="position: absolute; top: 15px; left: 15px; background: ${animal.color}; color: white; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 14px;">${animal.number}</div>
                <div style="font-size: 48px; margin-bottom: 15px; color: ${animal.color};">${animal.icon}</div>
                <div style="font-size: 18px; font-weight: 800; color: var(--text-primary); margin-bottom: 5px;">${animal.name}</div>
                <div style="color: var(--text-tertiary); font-size: 12px; margin-bottom: 8px;">Grupo ${animal.group}</div>
                <div style="color: var(--accent); font-weight: 600; font-size: 14px;">${animal.odds}x</div>
            `;

            card.addEventListener('click', () => toggleAnimalSelection(animal));
            grid.appendChild(card);
        });
    }

    function toggleAnimalSelection(animal) {
        const index = selectedAnimals.findIndex(a => a.number === animal.number);

        if (index === -1) {
            selectedAnimals.push(animal);
            document.querySelector(`.animal-card[data-number="${animal.number}"]`).classList.add('selected');
        } else {
            selectedAnimals.splice(index, 1);
            document.querySelector(`.animal-card[data-number="${animal.number}"]`).classList.remove('selected');
        }

        updateStats();
    }

    function selectBetType(type) {
        betType = type;
        document.querySelectorAll('.bet-type-btn').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');
        showNotification(`üéØ Modo ${getBetTypeName(type)} ativado`, 'info');
    }

    function getBetTypeName(type) {
        const names = {
            'simple': 'Aposta Simples',
            'multiple': 'Aposta M√∫ltipla',
            'group': 'Aposta em Grupo',
            'dezena': 'Dezena',
            'centena': 'Centena'
        };
        return names[type] || type;
    }

    function setQuickBet(amount) {
        currentBetAmount = amount;
        document.getElementById('betAmount').value = amount;
        document.getElementById('currentBetAmount').textContent = amount;
        updateStats();
    }

    function adjustBet(amount) {
        currentBetAmount = parseInt(document.getElementById('betAmount').value) || 10;
        currentBetAmount += amount;

        if (currentBetAmount < 1) currentBetAmount = 1;
        if (currentBetAmount > 1000) currentBetAmount = 1000;

        document.getElementById('betAmount').value = currentBetAmount;
        document.getElementById('currentBetAmount').textContent = currentBetAmount;
        updateStats();
    }

    function clearBets() {
        selectedAnimals = [];
        document.querySelectorAll('.animal-card.selected').forEach(card => card.classList.remove('selected'));
        document.getElementById('betAmount').value = 10;
        document.getElementById('currentBetAmount').textContent = 10;
        updateStats();
    }

    function updateStats() {
        const betAmount = parseInt(document.getElementById('betAmount').value) || 10;
        const totalBet = betAmount * selectedAnimals.length;
        const potentialWin = totalBet * 18;
        const winChance = selectedAnimals.length * 4;

        document.getElementById('totalBetAmount').textContent = `R$ ${totalBet}`;
        document.getElementById('potentialWin').textContent = `R$ ${potentialWin}`;
        document.getElementById('selectedAnimalsCount').textContent = selectedAnimals.length;
        document.getElementById('winChance').textContent = `${winChance}%`;
    }

    function showConfirmBetModal(betAmount, totalBet) {
        const animalsDiv = document.getElementById('confirmBetAnimals');
        animalsDiv.innerHTML = selectedAnimals.map(animal => `
            <div style="background: ${animal.color}20; border: 2px solid ${animal.color}; padding: 10px 15px; border-radius: var(--radius-sm); display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 24px;">${animal.icon}</span>
                <span style="font-weight: 600;">${animal.name}</span>
            </div>
        `).join('');

        document.getElementById('confirmBetAmountPerAnimal').textContent = `R$ ${betAmount.toFixed(2)}`;
        document.getElementById('confirmBetTotal').textContent = `R$ ${totalBet.toFixed(2)}`;
        document.getElementById('confirmBetPotentialWin').textContent = `R$ ${(totalBet * 18).toFixed(2)}`;

        showModal('confirmBetModal');
    }

    function showMainApp() {
        document.getElementById('authScreen').style.display = 'none';
        document.getElementById('navbar').style.display = 'block';
        showSection('home');
        updateUserDisplay();
    }

    function showSection(section) {
        document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
        setTimeout(() => {
            document.getElementById(`${section}Section`).classList.add('active');

            document.querySelectorAll('.nav-links a').forEach(link => link.classList.remove('active'));
            const activeLink = document.querySelector(`.nav-links a[onclick*="${section}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }

            switch(section) {
                case 'results':
                    loadRecentDraws();
                    loadTopWinners();
                    break;
                case 'settings':
                    loadProfileData();
                    break;
            }
        }, 10);
    }

    function updateUserDisplay() {
        if (!currentUserData) return;

        // Atualizar saldo
        const balanceElements = document.querySelectorAll('#userBalance, #accountBalance');
        balanceElements.forEach(el => {
            if (el) el.textContent = `R$ ${currentUserData.balance.toFixed(2)}`;
        });

        // Atualizar nome de usu√°rio
        const username = currentUserData.username || currentUserData.email.split('@')[0];
        const usernameElements = document.querySelectorAll('#profileUsername, #profileUsername2');
        usernameElements.forEach(el => {
            if (el) el.textContent = username;
        });
    }
    function updateBetsList() {
        const list = document.getElementById('betsList');

        if (userBets.length === 0) {
            list.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 40px;">Nenhuma aposta realizada ainda.</p>';
            return;
        }

        list.innerHTML = userBets.map(bet => `
            <div class="winner-item">
                <div style="font-size: 32px;">${bet.animal.icon}</div>
                <div style="flex: 1;">
                    <div style="font-weight: 700; margin-bottom: 5px;">${bet.animal.name} (#${bet.animal.number})</div>
                    <div style="font-size: 12px; color: var(--text-tertiary);">Sorteio #${bet.drawNumber}</div>
                </div>
                <div style="text-align: right;">
                    <div style="font-weight: 700; color: var(--accent);">R$ ${bet.amount.toFixed(2)}</div>
                    <div style="font-size: 12px; color: var(--text-tertiary);">Ganho: R$ ${bet.potentialWin.toFixed(2)}</div>
                </div>
            </div>
        `).join('');
    }

    function showModal(modalId) {
        document.getElementById(modalId).classList.add('active');
    }

    function closeModal(modalId) {
        document.getElementById(modalId).classList.remove('active');
    }

    function showNotification(message, type = 'info') {
        const container = document.getElementById('notificationContainer');
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
            <div class="notification-icon">
                ${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è'}
            </div>
            <div>
                <div style="font-weight: 700; margin-bottom: 5px; color: var(--text-primary);">${getNotificationTitle(type)}</div>
                <div style="color: var(--text-secondary); font-size: 14px;">${message}</div>
            </div>
        `;

        container.appendChild(notification);

        setTimeout(() => {
            notification.classList.add('show');
        }, 10);

        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => notification.remove(), 400);
        }, 4000);
    }

    function getNotificationTitle(type) {
        switch(type) {
            case 'success': return 'Sucesso!';
            case 'error': return 'Erro!';
            case 'warning': return 'Aten√ß√£o!';
            default: return 'Informa√ß√£o';
        }
    }

    function createConfetti() {
        const container = document.getElementById('confettiContainer');
        container.innerHTML = '';

        const colors = ['#10B981', '#3B82F6', '#8B5CF6', '#EC4899', '#F59E0B'];

        for (let i = 0; i < 150; i++) {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = Math.random() * 100 + 'vw';
            confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
            confetti.style.opacity = '1';

            container.appendChild(confetti);

            const animation = confetti.animate([
                {
                    top: '0px',
                    opacity: 1,
                    transform: `rotate(${Math.random() * 360}deg) scale(1)`
                },
                {
                    top: '100vh',
                    opacity: 0,
                    transform: `rotate(${Math.random() * 720}deg) scale(0)`
                }
            ], {
                duration: Math.random() * 3000 + 2000,
                easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
            });

            animation.onfinish = () => confetti.remove();
        }
    }

    function initTheme() {
        const themeToggle = document.getElementById('themeToggle');
        const thumb = themeToggle.querySelector('.theme-toggle__thumb');
        const html = document.documentElement;

        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            html.setAttribute('data-theme', 'dark');
            thumb.style.transform = 'translateX(30px)';
        } else {
            thumb.style.transform = 'translateX(4px)';
        }

        themeToggle.addEventListener('click', function() {
            if (html.hasAttribute('data-theme')) {
                html.removeAttribute('data-theme');
                localStorage.setItem('theme', 'light');
                thumb.style.transform = 'translateX(4px)';
            } else {
                html.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
                thumb.style.transform = 'translateX(30px)';
            }
        });
    }

    function initParticles() {
        particlesJS('particles-js', {
            particles: {
                number: { value: 80, density: { enable: true, value_area: 800 } },
                color: { value: "#10B981" },
                shape: { type: "circle" },
                opacity: { value: 0.2, random: true },
                size: { value: 3, random: true },
                line_linked: {
                    enable: true,
                    distance: 150,
                    color: "#10B981",
                    opacity: 0.1,
                    width: 1
                },
                move: {
                    enable: true,
                    speed: 1,
                    direction: "none",
                    random: true,
                    straight: false,
                    out_mode: "out"
                }
            },
            interactivity: {
                detect_on: "canvas",
                events: {
                    onhover: { enable: true, mode: "repulse" },
                    onclick: { enable: true, mode: "push" }
                }
            },
            retina_detect: true
        });
    }

    function updateGameStats() {
        // Estat√≠sticas s√£o atualizadas do Firestore em tempo real
    }

    function showResultModal(animal, amount, winningBets) {
        document.getElementById('resultAnimalIcon').textContent = animal.icon;
        document.getElementById('resultAmount').textContent = `R$ ${amount.toFixed(2)}`;

        if (amount > 0) {
            document.getElementById('resultMessage').textContent = 'üéâ PARAB√âNS! VOC√ä GANHOU!';
            document.getElementById('resultMessage').style.color = 'var(--accent)';
            document.getElementById('resultDescription').textContent =
                `O animal sorteado foi ${animal.name}. ${winningBets} aposta(s) vencedora(s)!`;
        } else {
            document.getElementById('resultMessage').textContent = 'üò¢ N√ÉO FOI DESSA VEZ!';
            document.getElementById('resultMessage').style.color = 'var(--danger)';
            document.getElementById('resultDescription').textContent =
                `O animal sorteado foi ${animal.name}. Tente novamente no pr√≥ximo sorteio!`;
        }

        showModal('resultModal');
    }

    // ==================== SISTEMA DE CONFIGURA√á√ïES ====================

    function showSettingsTab(tabName) {
        document.querySelectorAll('.settings-tab').forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('.settings-content').forEach(content => content.classList.remove('active'));

        document.querySelector(`.settings-tab[onclick*="${tabName}"]`).classList.add('active');
        document.getElementById(`${tabName}Tab`).classList.add('active');

        switch(tabName) {
            case 'profile':
                loadProfileData();
                break;
            case 'account':
                loadAccountData();
                break;
            case 'history':
                loadBetHistory();
                break;
        }
    }

    function loadProfileData() {
        if (!currentUserData) return;

        document.getElementById('profileUsername').textContent = currentUser.email.split('@')[0];
        document.getElementById('profileUsername2').textContent = currentUser.email.split('@')[0];
        document.getElementById('profileEmail').textContent = currentUser.email;
        document.getElementById('memberSince').textContent = currentUserData.memberSince;
        document.getElementById('totalBets').textContent = currentUserData.totalBets;
        document.getElementById('totalWins').textContent = currentUserData.totalWins;

        document.getElementById('profileName').value = currentUserData.fullName || '';
        document.getElementById('profilePhone').value = currentUserData.phone || '';

        const progress = (currentUserData.xp / currentUserData.nextLevelXp) * 100;
        document.getElementById('levelProgress').textContent = `${progress.toFixed(0)}%`;
        document.getElementById('levelProgressBar').style.width = `${progress}%`;
        document.getElementById('userLevel').textContent = `N√≠vel ${currentUserData.level}`;
    }

    function loadAccountData() {
        if (!currentUserData) return;
        document.getElementById('accountBalance').textContent = `R$ ${currentUserData.balance.toFixed(2)}`;
    }

    async function updateProfile() {
        if (!currentUserData) return;

        currentUserData.fullName = document.getElementById('profileName').value;
        currentUserData.phone = document.getElementById('profilePhone').value;

        await updateUserData();
        showNotification('‚úÖ Perfil atualizado com sucesso!', 'success');
    }

    function selectAmount(amount) {
        selectedDepositAmount = amount;
        document.querySelectorAll('.amount-option').forEach(option => {
            option.classList.remove('selected');
        });
        event.target.closest('.amount-option').classList.add('selected');
        document.getElementById('customAmount').value = amount;
    }

    function selectPayment(method) {
        selectedPaymentMethod = method;
        document.querySelectorAll('.payment-method').forEach(payment => {
            payment.classList.remove('selected');
        });
        event.target.closest('.payment-method').classList.add('selected');
    }

    async function addFunds() {
        if (!currentUserData) return;

        let amount = selectedDepositAmount || parseFloat(document.getElementById('customAmount').value) || 0;

        if (amount <= 0) {
            showNotification('‚ùå Digite um valor v√°lido!', 'error');
            return;
        }

        if (!selectedPaymentMethod) {
            showNotification('‚ùå Selecione um m√©todo de pagamento!', 'error');
            return;
        }

        let bonus = 0;
        if (amount >= 500) bonus = 100;
        else if (amount >= 250) bonus = 40;
        else if (amount >= 100) bonus = 15;
        else if (amount >= 50) bonus = 7;
        else if (amount >= 25) bonus = 3;
        else if (amount >= 10) bonus = 1;

        const total = amount + bonus;

        try {
            // Registrar transa√ß√£o no Firestore
            await db.collection('users').doc(currentUser.uid).collection('transactions').add({
                type: 'deposit',
                amount: amount,
                bonus: bonus,
                total: total,
                method: selectedPaymentMethod,
                status: 'completed',
                date: firebase.firestore.FieldValue.serverTimestamp()
            });

            // Atualizar saldo
            await db.collection('users').doc(currentUser.uid).update({
                balance: firebase.firestore.FieldValue.increment(total)
            });

            currentUserData.balance += total;
            updateUserDisplay();

            document.getElementById('depositAmount').textContent = `R$ ${amount.toFixed(2)}`;
            document.getElementById('depositBonus').textContent = `R$ ${bonus.toFixed(2)}`;
            document.getElementById('newBalance').textContent = `R$ ${currentUserData.balance.toFixed(2)}`;

            showModal('depositModal');

            selectedDepositAmount = 0;
            selectedPaymentMethod = '';
            document.getElementById('customAmount').value = '';
            document.querySelectorAll('.amount-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelectorAll('.payment-method').forEach(payment => {
                payment.classList.remove('selected');
            });
        } catch (error) {
            console.error('Erro ao adicionar fundos:', error);
            showNotification('‚ùå Erro ao processar dep√≥sito!', 'error');
        }
    }

    async function changePassword() {
        if (!currentUser) return;

        const currentPassword = document.getElementById('currentPassword').value;
        const newPassword = document.getElementById('newPassword').value;
        const confirmPassword = document.getElementById('confirmNewPassword').value;

        if (newPassword !== confirmPassword) {
            showNotification('‚ùå As novas senhas n√£o coincidem!', 'error');
            return;
        }

        try {
            const credential = firebase.auth.EmailAuthProvider.credential(
                currentUser.email,
                currentPassword
            );

            await currentUser.reauthenticateWithCredential(credential);
            await currentUser.updatePassword(newPassword);

            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmNewPassword').value = '';

            showNotification('‚úÖ Senha alterada com sucesso!', 'success');
        } catch (error) {
            console.error('Erro ao alterar senha:', error);
            showNotification('‚ùå Erro ao alterar senha! Verifique a senha atual.', 'error');
        }
    }

    async function savePreferences() {
        if (!currentUser || !currentUserData) return;

        const preferences = {
            notifications: document.getElementById('notifications').checked,
            promotions: document.getElementById('promotions').checked,
            soundEffects: document.getElementById('soundEffects').checked,
            language: document.getElementById('language').value
        };

        try {
            await db.collection('users')
                .doc(currentUser.uid)
                .collection('settings')
                .doc('preferences')
                .set(preferences);

            currentUserData.settings = preferences;
            showNotification('‚úÖ Prefer√™ncias salvas!', 'success');
        } catch (error) {
            console.error('Erro ao salvar prefer√™ncias:', error);
            showNotification('‚ùå Erro ao salvar prefer√™ncias!', 'error');
        }
    }

    async function deleteAccount() {
        if (!confirm('‚ö†Ô∏è Tem certeza que deseja excluir sua conta? Esta a√ß√£o n√£o pode ser desfeita.')) {
            return;
        }

        try {
            // Remover presen√ßa
            await updateUserPresence(false);

            // Deletar documento do usu√°rio
            await db.collection('users').doc(currentUser.uid).delete();

            // Deletar conta de autentica√ß√£o
            await currentUser.delete();

            showNotification('üì≠ Conta exclu√≠da com sucesso!', 'info');
            setTimeout(() => location.reload(), 2000);
        } catch (error) {
            console.error('Erro ao excluir conta:', error);
            showNotification('‚ùå Erro ao excluir conta! Voc√™ pode precisar fazer login novamente.', 'error');
        }
    }

    async function loadBetHistory() {
        if (!currentUserData) return;

        const historyDiv = document.getElementById('betHistory');

        try {
            const betsSnapshot = await db.collection('users')
                .doc(currentUser.uid)
                .collection('bets')
                .orderBy('date', 'desc')
                .limit(50)
                .get();

            if (betsSnapshot.empty) {
                historyDiv.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 40px;">Nenhuma aposta realizada ainda.</p>';
                return;
            }

            historyDiv.innerHTML = betsSnapshot.docs.map(doc => {
                const bet = doc.data();
                const date = bet.date ? bet.date.toDate() : new Date();
                return `
                    <div class="winner-item">
                        <div style="font-size: 32px;">${bet.animal.icon}</div>
                        <div style="flex: 1;">
                            <div style="font-weight: 700; margin-bottom: 5px;">${bet.animal.name} (#${bet.animal.number})</div>
                            <div style="font-size: 12px; color: var(--text-tertiary);">${date.toLocaleString()}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-weight: 700; color: ${bet.status === 'won' ? 'var(--accent)' : bet.status === 'pending' ? 'var(--warning)' : 'var(--danger)'};">R$ ${bet.amount.toFixed(2)}</div>
                            <div style="font-size: 12px; color: var(--text-tertiary);">${bet.status === 'won' ? `Ganhou: R$ ${bet.winAmount.toFixed(2)}` : bet.status === 'pending' ? 'Pendente' : 'Perdeu'}</div>
                        </div>
                    </div>
                `;
            }).join('');
        } catch (error) {
            console.error('Erro ao carregar hist√≥rico:', error);
        }
    }

    // ==================== FUN√á√ïES DE RESULTADOS ====================

    async function loadRecentDraws() {
        try {
            const drawsSnapshot = await db.collection('draws')
                .orderBy('date', 'desc')
                .limit(10)
                .get();

            const container = document.getElementById('recentDraws');

            if (drawsSnapshot.empty) {
                container.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 40px;">Nenhum sorteio registrado ainda.</p>';
                return;
            }

            container.innerHTML = drawsSnapshot.docs.map(doc => {
                const draw = doc.data();
                const date = draw.date ? draw.date.toDate() : new Date();
                return `
                    <div class="winner-item">
                        <div style="font-size: 32px;">${draw.animal.icon}</div>
                        <div style="flex: 1;">
                            <div style="font-weight: 700; margin-bottom: 5px;">${draw.animal.name} (#${draw.animal.number})</div>
                            <div style="font-size: 12px; color: var(--text-tertiary);">${date.toLocaleString()} - Sorteio #${draw.drawNumber}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-weight: 700; color: ${draw.winners > 0 ? 'var(--accent)' : 'var(--text-tertiary)'};">${draw.winners} ganhador(es)</div>
                            <div style="font-size: 12px; color: var(--text-tertiary);">Pr√™mio: R$ ${draw.prize.toFixed(2)}</div>
                        </div>
                    </div>
                `;
            }).join('');
        } catch (error) {
            console.error('Erro ao carregar sorteios:', error);
        }
    }

    async function loadTopWinners() {
        try {
            // Buscar maiores ganhos dos √∫ltimos 30 dias
            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);

            const drawsSnapshot = await db.collection('draws')
                .where('date', '>=', firebase.firestore.Timestamp.fromDate(thirtyDaysAgo))
                .orderBy('date', 'desc')
                .orderBy('prize', 'desc')
                .limit(5)
                .get();

            const container = document.getElementById('topWinners');

            if (drawsSnapshot.empty) {
                container.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 40px;">Nenhum ganhador nos √∫ltimos 30 dias.</p>';
                return;
            }

            container.innerHTML = drawsSnapshot.docs.map(doc => {
                const draw = doc.data();
                return `
                    <div class="winner-item">
                        <div style="width: 50px; height: 50px; border-radius: 50%; background: var(--accent-gradient); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 24px;">
                            ${draw.animal.icon}
                        </div>
                        <div style="flex: 1;">
                            <div style="font-weight: 700; margin-bottom: 5px;">${draw.animal.name}</div>
                            <div style="font-size: 12px; color: var(--text-tertiary);">Sorteio #${draw.drawNumber}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-weight: 700; color: var(--accent);">R$ ${draw.prize.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</div>
                            <div style="font-size: 12px; color: var(--text-tertiary);">${draw.winners} ganhador(es)</div>
                        </div>
                    </div>
                `;
            }).join('');
        } catch (error) {
            console.error('Erro ao carregar top winners:', error);
        }
    }

    // ==================== TUTORIAL ====================

    function nextTutorialStep(step) {
        document.querySelectorAll('.tutorial-modal-step').forEach(s => s.classList.remove('active'));
        document.getElementById(`tutorialStep${step}`).style.display = 'block';
        document.getElementById(`tutorialStep${step}`).classList.add('active');
        currentTutorialStep = step;
    }

    function closeTutorial() {
        closeModal('tutorialModal');
        showSection('betting');
        showNotification('üéâ Tutorial conclu√≠do! Boa sorte nas suas apostas!', 'success');
        localStorage.setItem('bichobet_tutorial_completed', 'true');
    }

    window.showTutorial = function() {
        currentTutorialStep = 1;
        document.querySelectorAll('.tutorial-modal-step').forEach(step => {
            step.style.display = 'none';
            step.classList.remove('active');
        });
        document.getElementById('tutorialStep1').style.display = 'block';
        document.getElementById('tutorialStep1').classList.add('active');
        showModal('tutorialModal');
    };

    // ==================== DETALHES DO ANIMAL ====================

    function showAnimalDetails(animal) {
        currentAnimalDetail = animal;

        document.getElementById('animalDetailIcon').textContent = animal.icon;
        document.getElementById('animalDetailName').textContent = animal.name;
        document.getElementById('animalDetailGroup').textContent = animal.group;
        document.getElementById('animalDetailNumber').textContent = animal.number;

        const lastSeen = Math.floor(Math.random() * 120) + 5;
        document.getElementById('animalLastSeen').textContent = `${lastSeen} min atr√°s`;

        const frequency = (Math.random() * 5 + 2).toFixed(1);
        document.getElementById('animalFrequency').textContent = `${frequency}%`;

        const popularities = ['Baixa üßä', 'M√©dia üå°Ô∏è', 'Alta üî•', 'Muito Alta üî•üî•'];
        document.getElementById('animalPopularity').textContent = popularities[Math.floor(Math.random() * popularities.length)];

        showModal('animalDetailsModal');
    }

    async function addToFavorites() {
        if (!currentAnimalDetail || !currentUser) return;

        const index = favoriteAnimals.findIndex(a => a.number === currentAnimalDetail.number);

        if (index === -1) {
            favoriteAnimals.push(currentAnimalDetail);
            showNotification(`‚≠ê ${currentAnimalDetail.name} adicionado aos favoritos!`, 'success');
        } else {
            favoriteAnimals.splice(index, 1);
            showNotification(`${currentAnimalDetail.name} removido dos favoritos!`, 'info');
        }

        try {
            await db.collection('users')
                .doc(currentUser.uid)
                .collection('settings')
                .doc('favorites')
                .set({ animals: favoriteAnimals });
        } catch (error) {
            console.error('Erro ao salvar favoritos:', error);
        }
    }

    function selectAnimalAndClose() {
        if (!currentAnimalDetail) return;
        toggleAnimalSelection(currentAnimalDetail);
        closeModal('animalDetailsModal');
    }

    // ==================== JOGO RESPONS√ÅVEL ====================

    async function saveResponsibleLimits() {
        const dailyLimit = parseFloat(document.getElementById('dailyLimit').value) || 0;
        const timeLimit = parseInt(document.getElementById('timeLimit').value) || 0;
        const selfExclude = document.getElementById('selfExclude').checked;

        responsibleLimits = { dailyLimit, timeLimit, selfExclude };

        if (selfExclude) {
            const exclusionEnd = new Date();
            exclusionEnd.setHours(exclusionEnd.getHours() + 24);
            responsibleLimits.selfExcludeUntil = firebase.firestore.Timestamp.fromDate(exclusionEnd);
        }

        if (currentUser) {
            try {
                await db.collection('users')
                    .doc(currentUser.uid)
                    .collection('settings')
                    .doc('limits')
                    .set(responsibleLimits);

                if (selfExclude) {
                    showNotification('‚ö†Ô∏è Autoexclus√£o ativada por 24 horas!', 'warning');
                    setTimeout(() => logout(), 2000);
                } else {
                    showNotification('‚úÖ Limites de jogo respons√°vel salvos!', 'success');
                }
            } catch (error) {
                console.error('Erro ao salvar limites:', error);
                showNotification('‚ùå Erro ao salvar limites!', 'error');
            }
        }

        closeModal('responsibleGamingModal');
    }

    window.showResponsibleGaming = function() {
        if (responsibleLimits.dailyLimit > 0) {
            document.getElementById('dailyLimit').value = responsibleLimits.dailyLimit;
        }
        if (responsibleLimits.timeLimit > 0) {
            document.getElementById('timeLimit').value = responsibleLimits.timeLimit;
        }
        document.getElementById('selfExclude').checked = false;

        showModal('responsibleGamingModal');
    };

    // ==================== PROMO√á√ïES ====================

    function loadPromotions() {
        const promotions = [
            {
                title: 'üéÅ B√¥nus de Boas-Vindas',
                description: 'Ganhe 100% no primeiro dep√≥sito at√© R$ 200',
                validity: '7 dias',
                active: true
            },
            {
                title: 'üî• Cashback Semanal',
                description: '10% de cashback em todas as apostas perdidas',
                validity: 'Toda semana',
                active: true
            },
            {
                title: '‚≠ê Programa VIP',
                description: 'N√≠veis exclusivos com b√¥nus e pr√™mios especiais',
                validity: 'Permanente',
                active: true
            },
            {
                title: 'üéØ Desafio do M√™s',
                description: 'Aposte R$ 500 e ganhe R$ 100 de b√¥nus',
                validity: 'At√© 31/12',
                active: true
            }
        ];

        const list = document.getElementById('promotionsList');
        list.innerHTML = promotions.map(promo => `
            <div style="background: var(--light-secondary); padding: 25px; border-radius: var(--radius-md); border: 2px solid ${promo.active ? 'var(--accent)' : 'var(--border)'};">
                <h3 style="margin-bottom: 10px; color: var(--text-primary);">${promo.title}</h3>
                <p style="color: var(--text-secondary); margin-bottom: 15px;">${promo.description}</p>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="font-size: 12px; color: var(--text-tertiary);">V√°lido: ${promo.validity}</span>
                    <button class="btn btn-primary" style="padding: 10px 20px; font-size: 14px;" onclick="activatePromotion('${promo.title}')">
                        <i class="fas fa-gift"></i> Ativar
                    </button>
                </div>
            </div>
        `).join('');
    }

    function activatePromotion(title) {
        showNotification(`üéâ Promo√ß√£o "${title}" ativada!`, 'success');
        closeModal('promotionsModal');
    }

    window.showPromotions = function() {
        loadPromotions();
        showModal('promotionsModal');
    };

    // ==================== ESTAT√çSTICAS AVAN√áADAS ====================

    async function showAdvancedStats() {
        if (!currentUserData) return;

        try {
            const betsSnapshot = await db.collection('users')
                .doc(currentUser.uid)
                .collection('bets')
                .get();

            const allBets = betsSnapshot.docs.map(doc => doc.data());

            const totalBet = allBets.reduce((sum, bet) => sum + bet.amount, 0);
            const wonBets = allBets.filter(bet => bet.status === 'won');
            const totalWon = wonBets.reduce((sum, bet) => sum + (bet.winAmount || 0), 0);
            const winRate = allBets.length > 0 ? ((wonBets.length / allBets.length) * 100).toFixed(1) : 0;
            const biggestWin = Math.max(...wonBets.map(bet => bet.winAmount || 0), 0);

            document.getElementById('statsModalTotalBet').textContent = `R$ ${totalBet.toFixed(2)}`;
            document.getElementById('statsModalTotalWon').textContent = `R$ ${totalWon.toFixed(2)}`;
            document.getElementById('statsModalWinRate').textContent = `${winRate}%`;
            document.getElementById('statsModalBiggestWin').textContent = `R$ ${biggestWin.toFixed(2)}`;

            const animalCounts = {};
            allBets.forEach(bet => {
                const key = bet.animal.number;
                animalCounts[key] = (animalCounts[key] || 0) + 1;
            });

            const sortedAnimals = Object.entries(animalCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);

            const favAnimalsDiv = document.getElementById('statsModalFavoriteAnimals');
            favAnimalsDiv.innerHTML = sortedAnimals.map(([number, count]) => {
                const animal = animals.find(a => a.number === parseInt(number));
                return `
                    <div style="display: flex; align-items: center; justify-content: space-between; padding: 15px; background: var(--light-secondary); border-radius: var(--radius-sm); margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <span style="font-size: 32px;">${animal.icon}</span>
                            <div>
                                <div style="font-weight: 700;">${animal.name}</div>
                                <div style="font-size: 12px; color: var(--text-tertiary);">#{animal.number}</div>
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-weight: 800; color: var(--accent);">${count}x</div>
                            <div style="font-size: 12px; color: var(--text-tertiary);">apostas</div>
                        </div>
                    </div>
                `;
            }).join('') || '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">Nenhum dado dispon√≠vel</p>';

            const recentBets = allBets.slice(-10).reverse();
            const recentBetsDiv = document.getElementById('statsModalRecentBets');
            recentBetsDiv.innerHTML = recentBets.map(bet => `
                <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px; border-bottom: 1px solid var(--border);">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <span style="font-size: 24px;">${bet.animal.icon}</span>
                        <div>
                            <div style="font-weight: 600; font-size: 14px;">${bet.animal.name}</div>
                            <div style="font-size: 11px; color: var(--text-tertiary);">${bet.date ? new Date(bet.date.seconds * 1000).toLocaleString() : 'Recente'}</div>
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-weight: 700; color: ${bet.status === 'won' ? 'var(--accent)' : 'var(--danger)'}; font-size: 14px;">
                            ${bet.status === 'won' ? '+' : '-'}R$ ${bet.amount.toFixed(2)}
                        </div>
                        <div style="font-size: 11px; color: var(--text-tertiary);">${bet.status === 'won' ? 'Ganhou' : bet.status === 'pending' ? 'Pendente' : 'Perdeu'}</div>
                    </div>
                </div>
            `).join('') || '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">Nenhuma aposta recente</p>';

            showModal('statsModal');
        } catch (error) {
            console.error('Erro ao carregar estat√≠sticas:', error);
            showNotification('‚ùå Erro ao carregar estat√≠sticas!', 'error');
        }
    }

    window.showStats = function() {
        showAdvancedStats();
    };

    // ==================== SUPORTE ====================

    async function sendSupportMessage(event) {
        event.preventDefault();

        const subject = document.getElementById('supportSubject').value;
        const message = document.getElementById('supportMessage').value;

        if (!message.trim()) {
            showNotification('‚ùå Por favor, escreva uma mensagem!', 'error');
            return;
        }

        if (currentUser) {
            try {
                await db.collection('support_tickets').add({
                    userId: currentUser.uid,
                    email: currentUser.email,
                    subject,
                    message,
                    status: 'pending',
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                showNotification('‚úÖ Mensagem enviada! Responderemos em breve.', 'success');
                closeModal('supportModal');
                document.getElementById('supportMessage').value = '';
            } catch (error) {
                console.error('Erro ao enviar mensagem:', error);
                showNotification('‚ùå Erro ao enviar mensagem!', 'error');
            }
        }
    }

    window.showSupport = function() {
        showModal('supportModal');
    };

    // ==================== CONQUISTAS ====================

    const achievements = [
        { id: 'first_bet', icon: 'üéØ', title: 'Primeira Aposta', description: 'Realize sua primeira aposta', requirement: 1 },
        { id: 'bet_10', icon: 'üîü', title: 'Apostador Iniciante', description: 'Realize 10 apostas', requirement: 10 },
        { id: 'bet_50', icon: '‚≠ê', title: 'Apostador Experiente', description: 'Realize 50 apostas', requirement: 50 },
        { id: 'bet_100', icon: 'üíé', title: 'Apostador Veterano', description: 'Realize 100 apostas', requirement: 100 },
        { id: 'win_first', icon: 'üèÜ', title: 'Primeira Vit√≥ria', description: 'Ganhe sua primeira aposta', requirement: 1 },
        { id: 'win_10', icon: 'üéâ', title: 'Sortudo', description: 'Ganhe 10 apostas', requirement: 10 },
        { id: 'big_win', icon: 'üí∞', title: 'Grande Vencedor', description: 'Ganhe mais de R$ 500 em uma aposta', requirement: 500 },
        { id: 'all_animals', icon: 'ü¶Å', title: 'Conhecedor', description: 'Aposte em todos os 25 animais', requirement: 25 }
    ];

    function hasAchievement(id) {
        return userAchievements.includes(id);
    }

    function loadAchievements() {
        const list = document.getElementById('achievementsList');

        list.innerHTML = achievements.map(achievement => {
            const unlocked = hasAchievement(achievement.id);
            return `
                <div style="background: ${unlocked ? 'linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.05) 100%)' : 'var(--light-secondary)'}; padding: 25px; border-radius: var(--radius-md); border: 2px solid ${unlocked ? 'var(--accent)' : 'var(--border)'}; display: flex; align-items: center; gap: 20px; transition: var(--transition); ${unlocked ? '' : 'opacity: 0.6;'}">
                    <div style="font-size: 48px; ${unlocked ? '' : 'filter: grayscale(100%);'}">${achievement.icon}</div>
                    <div style="flex: 1;">
                        <h3 style="margin-bottom: 8px; color: var(--text-primary);">${achievement.title}</h3>
                        <p style="color: var(--text-secondary); font-size: 14px; margin-bottom: 10px;">${achievement.description}</p>
                        ${unlocked ?
                '<div style="color: var(--accent); font-weight: 600; font-size: 12px;"><i class="fas fa-check-circle"></i> Desbloqueado!</div>' :
                '<div style="color: var(--text-tertiary); font-size: 12px;"><i class="fas fa-lock"></i> Bloqueado</div>'
            }
                    </div>
                </div>
            `;
        }).join('');
    }

    window.showAchievements = function() {
        loadAchievements();
        showModal('achievementsModal');
    };

    // ==================== FUN√á√ïES DE DESENVOLVIMENTO ====================

    window.addTestCredits = async function(amount = 1000) {
        if (currentUserData) {
            currentUserData.balance += amount;
            await updateUserData();
            updateUserDisplay();
            showNotification(`üí∏ R$ ${amount} adicionados para testes!`, 'success');
            createConfetti();
        }
    };

    window.testDraw = async function() {
        const globalDoc = await db.collection('system').doc('global').get();
        if (globalDoc.exists) {
            await executeDraw(globalDoc.data().drawNumber);
        }
    };

    window.resetAccount = async function() {
        if (!confirm('Tem certeza que deseja resetar sua conta? Todos os dados ser√£o perdidos.')) {
            return;
        }

        try {
            if (currentUser) {
                const betsSnapshot = await db.collection('users').doc(currentUser.uid).collection('bets').get();
                const batch = db.batch();
                betsSnapshot.docs.forEach(doc => batch.delete(doc.ref));
                await batch.commit();

                await db.collection('users').doc(currentUser.uid).update({
                    balance: 50,
                    totalBets: 0,
                    totalWins: 0,
                    level: 1,
                    xp: 0
                });

                location.reload();
            }
        } catch (error) {
            console.error('Erro ao resetar conta:', error);
            showNotification('‚ùå Erro ao resetar conta!', 'error');
        }
    };

    // ==================== INICIALIZA√á√ÉO ====================

    document.addEventListener('DOMContentLoaded', function() {
        initTheme();
        initAuthTabs();
        initAnimalsGrid();
        initTimer();
        initParticles();

        document.getElementById('betAmount').addEventListener('input', function() {
            currentBetAmount = parseInt(this.value) || 1;
            if (currentBetAmount < 1) {
                currentBetAmount = 1;
                this.value = 1;
            }
            if (currentBetAmount > 1000) {
                currentBetAmount = 1000;
                this.value = 1000;
            }
            document.getElementById('currentBetAmount').textContent = currentBetAmount;
            updateStats();
        });

        document.addEventListener('click', function(e) {
            const animalCard = e.target.closest('.animal-card');
            if (animalCard && e.ctrlKey) {
                const animalNumber = parseInt(animalCard.dataset.number);
                const animal = animals.find(a => a.number === animalNumber);
                if (animal) {
                    showAnimalDetails(animal);
                }
            }
        });

        if (!localStorage.getItem('bichobet_tutorial_completed')) {
            setTimeout(() => {
                if (currentUser) {
                    showTutorial();
                }
            }, 3000);
        }

        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        if (loginForm) loginForm.style.display = 'block';
        if (registerForm) registerForm.style.display = 'none';
    });



    let unsubscribeGlobal = null;


    // ==================== TIMER DE COUNTDOWN ====================

    // ==================== PROCESSAR RESULTADO DO SORTEIO ====================
    async function processDrawResult(draw) {
        if (!currentUser || !currentUserData) return;

        try {
            let totalWinnings = 0;
            let winningBets = 0;
            let losingBets = 0;

            // Buscar apostas do usu√°rio para este sorteio
            const userBetsSnapshot = await db.collection('users')
                .doc(currentUser.uid)
                .collection('bets')
                .where('drawNumber', '==', draw.drawNumber)
                .get();

            console.log(`Processando ${userBetsSnapshot.size} apostas para sorteio #${draw.drawNumber}`);

            userBetsSnapshot.docs.forEach(doc => {
                const bet = doc.data();
                if (bet.status === 'won') {
                    totalWinnings += bet.winAmount || 0;
                    winningBets++;
                } else if (bet.status === 'lost') {
                    losingBets++;
                }
            });

            // Recarregar dados do usu√°rio
            await loadUserData(currentUser.uid);
            updateUserDisplay();

            // Limpar apostas locais
            userBets = userBets.filter(bet => bet.drawNumber !== draw.drawNumber);
            updateBetsList();

            // Mostrar resultado
            if (totalWinnings > 0) {
                console.log(`üéâ Ganhou R$ ${totalWinnings}!`);
                showResultModal(draw.animal, totalWinnings, winningBets);
                createConfetti();

                // Tocar som de vit√≥ria
                if (currentUserData.settings?.soundEffects) {
                    playWinSound();
                }

                // Verificar conquistas
                await checkAchievements();
            } else if (losingBets > 0) {
                console.log(`üò¢ Perdeu ${losingBets} aposta(s)`);
                showResultModal(draw.animal, 0, 0);
            }

        } catch (error) {
            console.error('Erro ao processar resultado do sorteio:', error);
        }
    }

    // ==================== REALIZAR APOSTA (CORRIGIDO) ====================
    async function confirmAndPlaceBet() {
        closeModal('confirmBetModal');

        const betAmount = parseInt(document.getElementById('betAmount').value) || 10;
        let totalBet = betAmount * selectedAnimals.length;

        if (betType === 'multiple' && selectedAnimals.length > 1) {
            totalBet = Math.floor(totalBet * 0.9);
        }

        try {
            // Obter pr√≥ximo n√∫mero de sorteio
            const globalDoc = await db.collection('system').doc('global').get();

            if (!globalDoc.exists) {
                throw new Error('Sistema n√£o inicializado');
            }

            const currentDrawNumber = globalDoc.data().drawNumber;

            console.log(`Criando apostas para sorteio #${currentDrawNumber}`);

            // Criar apostas em batch
            const batch = db.batch();

            for (const animal of selectedAnimals) {
                // ID √∫nico para a aposta
                const betRef = db.collection('users').doc(currentUser.uid)
                    .collection('bets').doc();

                const bet = {
                    animal: {
                        number: animal.number,
                        name: animal.name,
                        icon: animal.icon,
                        group: animal.group,
                        odds: animal.odds
                    },
                    amount: betAmount,
                    potentialWin: betAmount * animal.odds,
                    status: 'pending',
                    type: betType,
                    drawNumber: currentDrawNumber,
                    date: firebase.firestore.FieldValue.serverTimestamp()
                };

                batch.set(betRef, bet);

                // Adicionar √† fila de apostas pendentes
                const pendingBetRef = db.collection('pending_bets').doc();
                batch.set(pendingBetRef, {
                    ...bet,
                    userId: currentUser.uid,
                    betId: betRef.id,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                // Adicionar ao estado local
                userBets.push({ ...bet, id: betRef.id });
            }

            // Atualizar saldo e estat√≠sticas
            const userRef = db.collection('users').doc(currentUser.uid);
            batch.update(userRef, {
                balance: firebase.firestore.FieldValue.increment(-totalBet),
                totalBets: firebase.firestore.FieldValue.increment(selectedAnimals.length),
                xp: firebase.firestore.FieldValue.increment(selectedAnimals.length * 5)
            });

            // Commit do batch
            await batch.commit();

            console.log(`‚úÖ ${selectedAnimals.length} aposta(s) criada(s) com sucesso!`);

            // Atualizar localmente
            currentUserData.balance -= totalBet;
            currentUserData.totalBets += selectedAnimals.length;
            currentUserData.xp += selectedAnimals.length * 5;

            // Verificar conquistas
            await checkAchievements();

            // Verificar level up
            checkLevelUp();

            updateUserDisplay();
            updateBetsList();

            // Limpar sele√ß√£o
            selectedAnimals = [];
            document.querySelectorAll('.animal-card.selected')
                .forEach(card => card.classList.remove('selected'));
            updateStats();

            showNotification(
                `‚úÖ ${userBets.length} aposta(s) realizada(s)! Total: R$ ${totalBet.toFixed(2)}`,
                'success'
            );
            createConfetti();

        } catch (error) {
            console.error('Erro ao realizar aposta:', error);
            showNotification('‚ùå Erro ao processar aposta: ' + error.message, 'error');
        }
    }

    // ==================== LIMPAR LISTENERS AO SAIR ====================
    function cleanupListeners() {
        if (unsubscribeDraws) {
            unsubscribeDraws();
            unsubscribeDraws = null;
        }
        if (unsubscribeGlobal) {
            unsubscribeGlobal();
            unsubscribeGlobal = null;
        }
    }

    // Chamar ao fazer logout
    async function logout() {
        try {
            cleanupListeners();
            await updateUserPresence(false);
            await auth.signOut();
            location.reload();
        } catch (error) {
            console.error('Erro ao fazer logout:', error);
        }
    }
    async function initializeGlobalDrawSystem() {
        try {
            console.log('üöÄ Iniciando sistema global...');

            const globalRef = db.collection('system').doc('global');
            const globalDoc = await globalRef.get();

            if (!globalDoc.exists) {
                console.log('‚ö†Ô∏è Sistema n√£o inicializado. Criando documento global...');

                const now = new Date();
                const minutes = now.getMinutes();
                const nextMinutes = Math.ceil(minutes / 5) * 5;

                const nextDraw = new Date(now);
                nextDraw.setMinutes(nextMinutes, 0, 0);

                if (nextMinutes >= 60) {
                    nextDraw.setHours(nextDraw.getHours() + 1);
                    nextDraw.setMinutes(0, 0, 0);
                }

                await globalRef.set({
                    jackpot: 25847.50,
                    nextDrawTime: firebase.firestore.Timestamp.fromDate(nextDraw),
                    drawNumber: 202412345,
                    onlinePlayers: 0,
                    lastUpdate: firebase.firestore.FieldValue.serverTimestamp()
                });

                console.log('‚úÖ Sistema inicializado com sucesso!');
                console.log('üìÖ Pr√≥ximo sorteio:', nextDraw.toLocaleString('pt-BR'));
            } else {
                console.log('‚úÖ Sistema j√° inicializado');
                const data = globalDoc.data();
                console.log('üìä Dados do sistema:');
                console.log('   - Jackpot: R$', data.jackpot);
                console.log('   - Draw Number:', data.drawNumber);
                console.log('   - Pr√≥ximo sorteio:', data.nextDrawTime?.toDate().toLocaleString('pt-BR'));
                console.log('   - Jogadores online:', data.onlinePlayers);
            }
        } catch (error) {
            console.error('‚ùå ERRO ao inicializar sistema global:', error);
            console.error('Detalhes:', error.message);
            throw error;
        }
    }
    // ==================== INICIALIZA√á√ÉO PRINCIPAL ====================
    auth.onAuthStateChanged(async (user) => {
        console.log('üîÑ Estado de autentica√ß√£o mudou:', user ? user.email : 'Nenhum usu√°rio');

        if (user) {
            try {
                currentUser = user;
                console.log('‚úÖ Usu√°rio autenticado:', user.email);

                // 1. Inicializar sistema global PRIMEIRO
                console.log('‚è≥ Inicializando sistema global...');
                await initializeGlobalDrawSystem();

                // 2. Carregar dados do usu√°rio
                console.log('‚è≥ Carregando dados do usu√°rio...');
                await loadUserData(user.uid);

                // 3. Marcar presen√ßa online
                console.log('‚è≥ Marcando presen√ßa online...');
                await updateUserPresence(true);

                // 4. Iniciar timer
                console.log('‚è≥ Iniciando timer...');
                initTimer();

                // 5. Mostrar app
                console.log('‚è≥ Mostrando interface...');
                showMainApp();

                console.log('‚úÖ App totalmente inicializado!');

            } catch (error) {
                console.error('‚ùå ERRO CR√çTICO na inicializa√ß√£o:', error);
                showNotification('‚ùå Erro ao inicializar: ' + error.message, 'error');
            }
        } else {
            console.log('üëã Usu√°rio desconectado');
            currentUser = null;
            currentUserData = null;

            // Limpar listeners
            if (window.unsubscribeGlobal) {
                window.unsubscribeGlobal();
                window.unsubscribeGlobal = null;
            }
        }
    });

    // ==================== DIAGN√ìSTICO ====================
    window.diagnosticar = async function() {
        console.log('\n========== DIAGN√ìSTICO DO SISTEMA ==========\n');

        // 1. Verificar Firebase
        console.log('1Ô∏è‚É£ Firebase inicializado:', !!firebase.apps.length);
        console.log('   Auth:', !!auth);
        console.log('   Firestore:', !!db);

        // 2. Verificar autentica√ß√£o
        console.log('\n2Ô∏è‚É£ Usu√°rio atual:', currentUser ? currentUser.email : 'Nenhum');
        console.log('   Dados do usu√°rio:', currentUserData ? 'OK' : 'N√£o carregado');

        // 3. Verificar documento global
        try {
            const globalDoc = await db.collection('system').doc('global').get();
            console.log('\n3Ô∏è‚É£ Documento global:', globalDoc.exists ? 'EXISTE' : 'N√ÉO EXISTE');
            if (globalDoc.exists) {
                const data = globalDoc.data();
                console.log('   Jackpot:', data.jackpot);
                console.log('   Draw Number:', data.drawNumber);
                console.log('   Next Draw:', data.nextDrawTime?.toDate().toLocaleString('pt-BR'));
                console.log('   Online Players:', data.onlinePlayers);
            }
        } catch (error) {
            console.error('‚ùå Erro ao verificar global:', error);
        }

        // 4. Verificar elementos da UI
        console.log('\n4Ô∏è‚É£ Elementos da UI:');
        console.log('   Timer element:', !!document.getElementById('drawTimer'));
        console.log('   Jackpot element:', !!document.getElementById('jackpotAmount'));
        console.log('   Balance element:', !!document.getElementById('userBalance'));

        // 5. Verificar listeners
        console.log('\n5Ô∏è‚É£ Listeners:', window.unsubscribeGlobal ? 'Ativo' : 'N√£o ativo');

        console.log('\n==========================================\n');
    };

    // Executar diagn√≥stico automaticamente ap√≥s 3 segundos do login
    setTimeout(() => {
        if (currentUser) {
            console.log('üîç Executando diagn√≥stico autom√°tico...');
            window.diagnosticar();
        }
    }, 3000);



</script>
</body>
</html>
